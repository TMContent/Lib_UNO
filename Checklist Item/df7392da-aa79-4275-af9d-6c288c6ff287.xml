<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="-540427069" Content_Hash="-1551061771">
  <Metadata>
    <Id>df7392da-aa79-4275-af9d-6c288c6ff287</Id>
    <Id_History>df7392da-aa79-4275-af9d-6c288c6ff287,dd185bc1-4c65-44d8-ad68-abb753a90acd,</Id_History>
    <Library_Id>be5273b1-d682-4361-99d9-6234f2d47eb7</Library_Id>
    <Title>[1612Dupe] Important Business Operations Are Logged</Title>
    <Category>Auditing and Logging</Category>
    <Phase>Design</Phase>
    <Technology>C++</Technology>
    <Type>Checklist Item</Type>
    <DirectLink>Important Business Operations Are Logged</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority />
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="html">
    <Data><![CDATA[<h1>What to Check For</h1>
  <p>Verify that important business operations are logged.</p>
  <h1>Why</h1>
  <p>Important business operations should be logged to help identify attacks in progress and to investigate attacks that have already occurred.</p>
  <h1>How to Check</h1>
  <p>Perform the following actions to check if important business operations are logged.</p>
  <ol>
    <li>
      <p>
        <strong>List important business operations.</strong> Make a list of business operations carried out by the application, such as placing orders, manipulating inventory, etc. Identify which of these operations are the most important.</p>
      <li>
        <p>
          <strong>Identify code that performs important business operations.</strong> Use the list of important business operations to find code that matches each one. Make a list of functions in this code.</p>
        <li>
          <p>
            <strong>Identify logging functionality.</strong> Examine the application architecture to identify logging facilities, such as the logging API and where audit trails are actually stored. Make a list of APIs used to log events, document how to use them, and where they store logs.</p>
          <li>
            <p>
              <strong>Verify that code logs important business operations.</strong> Use the list of functions that carry out important business operations and verify that each one uses the logging API to make records when important business operations take place.</p>
          </li>
        </li>
      </li>
    </li>
  </ol>
  <h1>How to Fix</h1>
  <p>Use the following steps to add code to log important business operations:</p>
  <ol>
    <li>
      <p>
        <strong>List important business operations.</strong> Make a list of business operations carried out by the application, such as placing orders, manipulating inventory, etc. Identify which of these operations are the most important.</p>
      <li>
        <p>
          <strong>Identify code that performs important business operations.</strong> Use the list of important business operations to find code that matches each one. Make a list of functions in this code.</p>
        <li>
          <p>
            <strong>Add logging functionality.</strong> Create a separate class or library to handle auditing and logging. Take time to design this library or class carefuly. Consider functionality to send logs to a remote log server. One of the most common protocols for interfacing with a remote log server is syslog (RFC 5424). Create and document an API for logging events with an adequate amount of information.</p>
          <li>
            <p>
              <strong>Add code that logs important business operations.</strong> Use the list of functions that carry out important business operations and add code to each function to use the logging API to make records when important business operations take place. Log both successful and failed events. Record success and failure indications.</p>
          </li>
        </li>
      </li>
    </li>
  </ol>
  <h1>Additional Resources</h1>
  <ul>
    <li>For more information about the syslog protocol, see <a href="http://tools.ietf.org/rfc/rfc5424.txt">http://tools.ietf.org/rfc/rfc5424.txt</a></li>
  </ul>]]></Data>
  </Content>
</TeamMentor_Article>