<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="429192179" Content_Hash="585109086">
  <Metadata>
    <Id>09a478f6-b186-4ce0-9d3b-b27164eeb8e9</Id>
    <Id_History>09a478f6-b186-4ce0-9d3b-b27164eeb8e9,005198de-6109-429b-a6c4-c0002e3b9e6a,</Id_History>
    <Library_Id>be5273b1-d682-4361-99d9-6234f2d47eb7</Library_Id>
    <Title>Dangerous APIs Are Avoided Or Used with Care</Title>
    <Category>Dangerous APIs</Category>
    <Phase>Implementation</Phase>
    <Technology>C++</Technology>
    <Type>Checklist Item</Type>
    <DirectLink>Dangerous APIs Are Avoided Or Used with Care</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority />
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<h1>Applies to</h1>
  <ul>
    <li>C&amp;#43;&amp;#43;</li>
  </ul>
  <h1>What to Check For</h1>
  <p>Verify that dangerous APIs are used with care when they are used.</p>
  <h1>Why</h1>
  <p>Some APIs have been shown historically to be the most likely to result in security vulnerabilities. These APIs are known as dangerous APIs. Special care should be taken when using them to avoid making typical mistakes that result in vulnerabilities. Specifically, input and data passed to dangerous APIs should be validated, and user input should not be used in format strings.</p>
  <h1>How to Check</h1>
  <p>Identify all code that uses any of the following dangerous APIs:</p>
  <ul>
    <li>strcpy&amp;nbsp;&amp;nbsp; <li>strcat&amp;nbsp;&amp;nbsp; <li>strcat&amp;nbsp; <li>strlen&amp;nbsp; <li>strncpy <li>strncat&amp;nbsp; <li>strcmp&amp;nbsp; <li>strcmp&amp;nbsp; <li>mbcstows<li>_strdup&amp;nbsp; <li>_strrev&amp;nbsp; <li>strstr&amp;nbsp; <li>strstr&amp;nbsp; <li>sprintf&amp;nbsp;&amp;nbsp; <li>_snprintf&amp;nbsp;&amp;nbsp; <li>printf&amp;nbsp;&amp;nbsp; <li>fprintf&amp;nbsp;&amp;nbsp; <li>gets&amp;nbsp; <li>scanf&amp;nbsp;&amp;nbsp; <li>fscanf&amp;nbsp;&amp;nbsp; <li>sscanf&amp;nbsp;&amp;nbsp;&amp;nbsp; <li>strcspn&amp;nbsp; <li>MultiByteToWideChar<li>WideCharToMultiByte <li>GetShortPathNameW&amp;nbsp; <li>GetLongPathNameW&amp;nbsp; <li>WinExec&amp;nbsp; <li>CreateProcessW&amp;nbsp; <li>GetEnvironmentVariableW&amp;nbsp; <li>SetEnvironmentVariableW&amp;nbsp; <li>SetEnvironmentVariableW&amp;nbsp; <li>ExpandEnvironmentStringsW&amp;nbsp; <li>SearchPathW&amp;nbsp; <li>SearchPathW&amp;nbsp; <li>SearchPathW&amp;nbsp; <li>Lstrcpy&amp;nbsp;&amp;nbsp; <li>Wcscpy&amp;nbsp;&amp;nbsp; <li>_mbscpy&amp;nbsp;&amp;nbsp; <li>StrCpyA&amp;nbsp;&amp;nbsp; <li>StrCpyW&amp;nbsp;&amp;nbsp; <li>lstrcatA&amp;nbsp;&amp;nbsp; <li>lstrcatW&amp;nbsp;&amp;nbsp; <li>Wcscat&amp;nbsp;&amp;nbsp; <li>_mbscat&amp;nbsp;&amp;nbsp; <li>Wcslen&amp;nbsp; <li>_mbslen&amp;nbsp; <li>_mbstrlen&amp;nbsp; <li>lstrlenA&amp;nbsp; <li>lstrlenW&amp;nbsp; <li>Wcsncpy <li>_mbsncpy <li>StrCpyN <li>lstrcpynW&amp;nbsp; <li>lstrcatnA&amp;nbsp; <li>lstrcatnW&amp;nbsp; <li>wcsncat&amp;nbsp; <li>_mbsncat&amp;nbsp; <li>_mbsnbcat&amp;nbsp;&amp;nbsp; <li>lstrcmpA&amp;nbsp; <li>lstrcmpW&amp;nbsp; <li>StrCmp&amp;nbsp; <li>Wcscmp&amp;nbsp; <li>_mbscmp&amp;nbsp; <li>strcoll&amp;nbsp; <li>wcscoll&amp;nbsp; <li>_mbscoll&amp;nbsp; <li>_stricmp&amp;nbsp; <li>lstrcmpiA&amp;nbsp; <li>lstrcmpiW&amp;nbsp; <li>_wcsicmp&amp;nbsp; <li>_mbsicmp&amp;nbsp; <li>StrCmp&amp;nbsp; <li>_stricoll&amp;nbsp; <li>_wcsicoll&amp;nbsp; <li>_mbsicoll&amp;nbsp; <li>StrColl&amp;nbsp; <li>_wcsdup&amp;nbsp; <li>_mbsdup&amp;nbsp; <li>StrDup&amp;nbsp; <li>_wcsrev&amp;nbsp; <li>_mbsrev&amp;nbsp; <li>_strlwr&amp;nbsp; <li>_mbslwr&amp;nbsp; <li>_wcslwr&amp;nbsp; <li>_strupr&amp;nbsp; <li>_mbsupr&amp;nbsp; <li>_wcsupr&amp;nbsp; <li>wcsstr&amp;nbsp; <li>_mbsstr&amp;nbsp; <li>strspn&amp;nbsp; <li>wcsspn&amp;nbsp; <li>_mbsspn&amp;nbsp; <li>strpbrk&amp;nbsp; <li>wcspbrk&amp;nbsp; <li>_mbspbrk&amp;nbsp; <li>wcsxfrm&amp;nbsp; <li>wcscspn&amp;nbsp; <li>_mbcscpn&amp;nbsp; <li>swprintf&amp;nbsp; <li>wsprintfA&amp;nbsp; <li>wsprintfW&amp;nbsp; <li>vsprintf&amp;nbsp; <li>vswprintf&amp;nbsp; <li>_snwprintf&amp;nbsp; <li>_vsnprintf&amp;nbsp; <li>_vsnwprintf&amp;nbsp; <li>vprintf&amp;nbsp; <li>vwprintf&amp;nbsp; <li>vfprintf&amp;nbsp; <li>vwfprintf&amp;nbsp; <li>_getws&amp;nbsp; <li>fwscanf&amp;nbsp; <li>wscanf&amp;nbsp; <li>swscanf&amp;nbsp; <li>OemToCharA&amp;nbsp;&amp;nbsp; <li>OemToCharW&amp;nbsp;&amp;nbsp; <li>CharToOemA&amp;nbsp;&amp;nbsp; <li>CharToOemW&amp;nbsp;&amp;nbsp; <li>CharUpperA&amp;nbsp; <li>CharUpperW&amp;nbsp; <li>CharUpperBuffW&amp;nbsp; <li>CharLowerA&amp;nbsp; <li>CharLowerW&amp;nbsp; <li>CharLowerBuffW&amp;nbsp; </li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li></li>
  </ul>
  <p>Verify that input and data validation is performed when any of these functions are called. Verify that user input is not used in format strings, if any.</p>
  <h1>How to Fix</h1>
  <p>Identify all code that uses any of the dangerous APIs as listed in the "How to Check" section. If possible, rewrite this code so that dangerous APIs are not used. Otherwise, add code that performs input and data validation when any of these functions are called. It is recommended to write a dedicated input and data validation class or library and use it. Pay special attention to functions that use format strings. If there is even a remote possibility of user input being used in the format strings, rewrite code so that it is impossible.</p>
  <h1>Related Items</h1>
  <ul>
    <li>
      <a href="/article/3f725650-1e28-4ee0-810c-133cd5912c91">Do Not Use Dangerous APIs</a>
    </li>
  </ul>]]></Data>
  </Content>
</TeamMentor_Article>