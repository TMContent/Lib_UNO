<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="922913914" Content_Hash="-1981573447">
  <Metadata>
    <Id>aaea1617-4224-47e9-aeec-60eb2ff55fab</Id>
    <Id_History>54ea1759-e5e8-4eee-84cc-67607fef0c30,</Id_History>
    <Library_Id>c4b9cb6a-4561-4451-9b6c-4e59d73584f6</Library_Id>
    <Title>Indirect Object References Are Used</Title>
    <Category>Authorization</Category>
    <Phase>Design</Phase>
    <Technology>Java</Technology>
    <Type>Checklist Item</Type>
    <DirectLink>Indirect Object References Are Used</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority />
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<h1>Applies to</h1>
  <ul>
    <li>Java</li>
  </ul>
  <h1>What to Check For</h1>
  <p>Verify that per-user or per-session indirect object references are used instead of direct object references.</p>
  <h1>Why</h1>
  <p>Using direct object references may expose sensitive data to attackers. Direct object references often expose sensitive data, such as files, database entries, or personal information. Direct object reference attacks are very simple to execute and have been used in high profile, low-skill attacks. Indirect object references should be used to prevent direct object reference vulnerabilities. Please, note that another approach to mitigating direct object reference vulnerabilities is to perform access control checks whenever accessing objects.</p>
  <h1>How to Check</h1>
  <p>To verify that indirect object references are used:</p>
  <ol>
    <li>
      <p>
        <strong>Identify pages that use object references.</strong> Make a list of all pages in the application. Go through the list and identify all pages that use object references by examining each page.</p>
      <li>
        <p>
          <strong>Verify that indirect object references are used.</strong> Examine each page that uses object references to make sure that indirect object references are used instead of direct object references.</p>
      </li>
    </li>
  </ol>
  <h1>How to Fix</h1>
  <p>To use indirect object references:</p>
  <ol>
    <li>
      <p>
        <strong>Identify pages that use direct object references.</strong> Make a list of all pages in the application. Go through the list and identify all pages that use direct object references by examining each page.</p>
      <li>
        <p>
          <strong>Identify objects that are being referenced.</strong> For each page that uses direct object references, make a list of all objects that are being referenced.</p>
        <li>
          <p>
            <strong>Consider alternatives.</strong> Using indirect object references may require significant changes to the application. Please, consider not using object references at all or performing access control checks each time an object is referenced. Not using object references means replacing all code that performs object references. Performing access control checks means adding code that performs access control checks to code that performs object references.</p>
          <li>
            <p>
              <strong>Define object reference maps.</strong> Object reference maps are arrays or hashes of objects that are being referenced. The web application exposes the index of the array or the key of the hash that matches the required resource, rather than exposing the object itself. This approach ensures that only objects in the array may be accessed. For this approach to work, reference maps should only include objects for which access is authorized. It is possible to use per-user or per-session object mappings. Per-user mappings define objects that may be accessed by each user. Per-session mappings define objects that may be accessed by each user for the current session. Per-session references may offer additional security or flexibility, but require more work. Mappings should be generated dynamically and that means that code has to be written that defines objects that may be accessed by each user. </p>
            <li>
              <p>
                <strong>Use reference maps instead of direct object references.</strong> Once the code that defines object reference maps is written, all the pages that reference objects have to be updated to use the reference maps.</p>
            </li>
          </li>
        </li>
      </li>
    </li>
  </ol>
  <h1>Additional Resources</h1>
  <ul>
    <li>For more information about preventing insecure direct object reference vulnerabilities, please see <a href="http://www.enterprisenetworkingplanet.com/netsecur/article.php/10952_3927401_1/Protect-Your-Web-Apps-From-Insecure-Direct-Object-References.htm">http://www.enterprisenetworkingplanet.com/netsecur/article.php/10952_3927401_1/Protect-Your-Web-Apps-From-Insecure-Direct-Object-References.htm</a><li>For information about using access reference maps in OWASP ESAPI, please see <a href="http://owasp-esapi-java.googlecode.com/svn/trunk_doc/latest/org/owasp/esapi/AccessReferenceMap.html">http://owasp-esapi-java.googlecode.com/svn/trunk_doc/latest/org/owasp/esapi/AccessReferenceMap.html</a></li></li>
  </ul>
  <h1>Authorization Guidelines</h1>
  <ul>
    <li>
      <a href="/article/127d98e8-d628-40b7-8522-d903f4bf7927">Perform Role-based Security Checks</a>
      <li>
        <a href="/article/afa2d020-9b18-4861-9d4f-cb81cbcb1f2e">Require Authentication and Authorization for All Sensitive Pages</a>
        <li>
          <a href="/article/12096ed3-d1e3-47e1-834d-f59dcaf4110f">Make Authentication and Authorization Policies Configurable</a>
          <li>
            <a href="/article/c0ff64c5-cf7f-4855-b039-81d2a298e3bb">Deny All Access by Default</a>
            <li>
              <a href="/article/92839e91-8f79-45fb-9b8d-76fc9c814fea">Check Access Control Permissions When Referencing Objects</a>
              <li>
                <a href="/article/b4a87891-a19a-41be-a1a3-f8a13c7f4881">Use Indirect Object References</a>
                <li>
                  <a href="/article/58e80d4a-410a-47c9-b3c5-f13cc79a3e00">Partition the Application Between Public and Private Domains</a>
                  <li>
                    <a href="/article/4b9647f2-644f-48bf-b2b5-cd025261450d">Secure the Account Administration Functionality</a>
                    <li>
                      <a href="/article/4f3147c2-7ca1-487c-9144-56630e5a6f80">Automatically Lock Inactive User Accounts</a>
                      <li>
                        <a href="/article/35bde9da-b8f2-4f8d-9a3f-48a3ededed4b">Consider Using JAAS for Authorization</a>
                      </li>
                    </li>
                  </li>
                </li>
              </li>
            </li>
          </li>
        </li>
      </li>
    </li>
  </ul>
  <h1>Authorization Checklists</h1>
  <ul>
    <li>
      <a href="/article/14f55778-8227-4d0d-85ca-41d80853bc58">Role-based Security Checks Are Performed</a>
      <li>
        <a href="/article/0d7d5d60-33bc-4fac-a088-f0be84d37cef">Authentication and Authorization Are Required for All Sensitive Pages</a>
        <li>
          <a href="/article/fb22da6b-bf1c-4315-83a5-7bc3486bf9ab">Authentication and Authorization Policies Are Configurable</a>
          <li>
            <a href="/article/98e8c0d1-d95a-4eb7-a39b-630c40c7adaf">All Access Is Denied by Default</a>
            <li>
              <a href="/article/f3747faf-6e0b-43af-ae92-ed3736be390a">Access Control Permissions Are Checked When Referencing Objects</a>
              <li>
                <a href="/article/54ea1759-e5e8-4eee-84cc-67607fef0c30">Indirect Object References Are Used</a>
                <li>
                  <a href="/article/3e451992-d7aa-43fd-ade8-656a87b787f8">The Application Is Partitioned into Public and Private Domains</a>
                  <li>
                    <a href="/article/7cc251c5-6e57-47a6-976e-365e8830f958">Account Administration Functionality Is Secured</a>
                    <li>
                      <a href="/article/a4f21cca-3db6-4eae-88d2-5d6b5f7ad2bb">Inactive User Accounts Are Automatically Locked</a>
                    </li>
                  </li>
                </li>
              </li>
            </li>
          </li>
        </li>
      </li>
    </li>
  </ul>]]></Data>
  </Content>
</TeamMentor_Article>