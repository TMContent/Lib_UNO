<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="1320478493" Content_Hash="924472961">
  <Metadata>
    <Id>3a327a2e-9f8f-490d-a991-8a6bfc4c4da5</Id>
    <Id_History>c9f3e7de-f955-4d44-bd47-52340793f204,</Id_History>
    <Library_Id>c4b9cb6a-4561-4451-9b6c-4e59d73584f6</Library_Id>
    <Title>Redirects And Forwards Are Not Used Unless Necessary</Title>
    <Category>Input and Data Validation</Category>
    <Phase>Design</Phase>
    <Technology> Any</Technology>
    <Type>Checklist Item</Type>
    <DirectLink>Redirects And Forwards Are Not Used Unless Necessary</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority />
    <Status />
    <Source>OWASP</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<h1>Applies to</h1>
  <ul>
    <li>Web Applications</li>
  </ul>
  <h1>What to Check For</h1>
  <p>Verify that redirects and forwards are not used unless necessary.</p>
  <h1>Why</h1>
  <p>Redirects or forwards may be manipulated by an attacker to create hyperlinks that appear to point to legitimate sites, but actually point to attacker-controlled malicious pages. This technique is oftened used by phishers to trick people into trusting a fake web site.</p>
  <h1>How to Check</h1>
  <p>Use the following steps to verify that redirects and forwards are not used unless necessary:</p>
  <ol>
    <li>
      <p>
        <strong>Review application design.</strong> Look through project documentation for any mentions of redirects or forwards (also known as transfers in .NET). Ideally, there should be no redirects or forwards in the application design.</p>
      <li>
        <p>
          <strong>Review code.</strong> Search code for redirects or forwards. Because there are many different ways to implement redirects and forwards, look through every page for code that handles parameters, and verify that this code doesn't perform redirects or forwards based on input.</p>
      </li>
    </li>
  </ol>
  <h1>How to Fix</h1>
  <p>Perform the following actions to avoid using redirects or forwards:</p>
  <ol>
    <li>
      <p>
        <strong>Enumerate redirects and forwards.</strong> Review application code to find all redirects and forwards used by the application.</p>
      <li>
        <p>
          <strong>Review application design.</strong> Determine how redirects and forwards figure into the application design. Consider making design changes to remove the need for redirects and forwards.</p>
        <li>
          <p>
            <strong>Remove redirects or forwards.</strong> Remove the redirects and forwards that are not necessary after changes to the application design.</p>
          <li>
            <p>
              <strong>Secure the remaining redirects or forwards.</strong> If there appears to be no reasonable way to get rid of redirects or forwards, use related guidelines to secure the remaining redirects or forwards.</p>
          </li>
        </li>
      </li>
    </li>
  </ol>
  <h1>Problem Example</h1>
  <p>Consider an on-line banking application that has an insecure redirect:</p>
  <pre>http://www.onlinebank.com/redirect.asp?url=&amp;#91;destination&amp;#93;</pre>
  <p>A phisher may create the following hyperlink to point to his own site and send it in spam messages to millions of people:</p>
  <pre>http://www.onlinebank.com/redirect.asp?url=www.phisher.com</pre>
  <p>When a user sees a link that appears to point to his bank at onlinebank.com in an e-mail message, he clicks that link and sees a web site that looks exactly like the bank's, but is actually a phishing web site used to steal authentication credentials. The user enters his account number and PIN into the web page, receives an error message telling him to try again, and is redirected to the bank's real site. After entering his credentials again, the user successfuly views his account. However, the phisher now has the user's online banking information.</p>
  <h1>Solution Example</h1>
  <p>The best solution to unvalidated redirects or forwards is to not use redirects or forwards at all. Considering the problem example above, a simple solution would be to remove the redirect.asp page after making the necessary changes to the application design.</p>
  <h1>Additional Resources</h1>
  <ul>
    <li>For more information about unvalidated redirects and forwards, please see <a href="http://www.owasp.org/index.php/Top_10_2010-A10-Unvalidated_Redirects_and_Forwards">http://www.owasp.org/index.php/Top_10_2010-A10-Unvalidated_Redirects_and_Forwards</a></li>
  </ul>
  <h1>Related Items</h1>
  <ul>
    <li>
      <a href="/article/0ed7310a-a0fd-4074-9c0f-37f48cf2bf4f">Don't Use Redirects or Forwards if Possible</a>
      <li>
        <a href="/article/be525e05-0785-4b0c-8266-1ab4a0be08ea">Calculate Destinations of Redirects and Forwards Without User Input</a>
        <li>
          <a href="/article/8a8fe651-2168-4c88-b89a-0b6b442da2f8">Use Mapping Values When Redirecting on User Input</a>
          <li>
            <a href="/article/26fc07d7-32fe-4823-9898-cf17f2582d8b">URL Redirection Attack</a>
            <li>
              <a href="/article/12f80857-1b6e-4c41-bc1c-83ff514b0056">How to Test for URL Redirection Bugs</a>
              <li>
                <a href="/article/61967ec5-3139-410c-a622-a4d07dd3a438">Phishing Attack<br /></a>
              </li>
            </li>
          </li>
        </li>
      </li>
    </li>
  </ul>]]></Data>
  </Content>
</TeamMentor_Article>