<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="339313805" Content_Hash="710465133">
  <Metadata>
    <Id>710f6680-1a52-4395-9d4c-555ec903eea3</Id>
    <Id_History>14a7c12b-46dd-4ee5-9ebf-8b9497ab7ce3,</Id_History>
    <Library_Id>c037d0d2-0617-44f3-b846-21dc3d02c4f8</Library_Id>
    <Title>Accounts Are Locked After Multiple Failed Authentication Attempts</Title>
    <Category>Authentication</Category>
    <Phase>Design</Phase>
    <Technology>PHP</Technology>
    <Type>Checklist Item</Type>
    <DirectLink>Accounts Are Locked After Multiple Failed Authentication Attempts</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority />
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<h1>Applies to</h1>
  <ul>
    <li>PHP</li>
  </ul>
  <h1>What to Check For</h1>
  <p>Ensure that accounts are locked after consecutive failed login attempts. </p>
  <h1>Why</h1>
  <p>Multiple, consecutive failed authentication attempts over a short period of time are a symptom that is used to detect when an account is under attack. Locking out the account prevents the attacker from compromising and accessing the account.</p>
  <h1>How to Check</h1>
  <p>Follow these steps to ensure your application will lock out an account after consecutive failed login attempts:</p>
  <ol>
    <li>
      <p>
        <strong>Verify that your application has a lockout policy.</strong> An account lockout policy is typically application specific. Review your application's requirements and design specifications and verify the following functionality:</p>
      <ul>
        <li>A mechanism for determining failed authentication attempts </li>
        <li>A mechanism for locking accounts that have exceeded the maximum number of allowed authentication attempts </li>
        <li>A mechanism for unlocking accounts that have exceeded the maximum number of allowed authentication attempts </li>
      </ul>
    </li>
    <li>
      <p>
        <strong>Ensure your application tracks login attempts.</strong> All authentication procedures record the number of authentication attempts for each user. The login counter for each user should be reset to 0 upon a successful authentication</p>
    </li>
    <li>
      <p>
        <strong>Ensure your application enforces the lockout policy.</strong> All authentication procedures implement your application's lockout policy. The implementation should match the lockout policy as the business requirements of your organization may change over time</p>
    </li>
    <li>
      <p>
        <strong>Test the application.</strong> Use a web browser to test authentication to make sure that repeated failed authentication attempts result in the user account being locked.</p>
    </li>
  </ol>
  <h1>How to Fix</h1>
  <p>Use the following steps to successfully lock accounts after consecutive failed login attempts:</p>
  <ol>
    <li>
      <p>
        <strong>Define a lockout policy.</strong> There are two variables to consider when determining a lockout policy:</p>
      <ul>
        <li>Number of allowed consecutive failed login attempts </li>
        <li>Amount of time that a locked account will remain locked </li>
      </ul>
      <p>A simple policy would be to lock an account after five failed login attempts for the duration of 15 minutes. Although this is an effective method for blocking a brute force attack, it exposes your application to denial of service as an attacker can easily keep an account locked through a small stream of authentication requests.</p>
      <p>When determining the lockout policy, it is important to evaluate the risk of attacks against the user and the support costs associated with reactivating a locked account. For example, requiring the user to contact your organization's support staff to reactivate a locked account will have a direct impact on support costs and would add general user frustration. However, it is important to use extra care when designing more sophisticated variations of your application's lockout policy, such as correlating a single or multiple user login attempts with a source IP. When adding extra levels of complexity, carefully consider and evaluate the scenarios where your application's lockout policy can be circumvented or can harm your business. For instance, consider scenarios where an attacker would attempt to compromise a user through the use of multiple hosts, or multiple users would authenticate using a shared office IP.</p>
      <p>
        <strong>Note:</strong> PCI DSS requirements state that an account should be locked out for at least 30 minutes after no more than six failed login attempts.</p>
    </li>
    <li>
      <p>
        <strong>Track login attempts.</strong> Login attempts can be tracked with the use of a login counter. Increment the counter once a user tries to authenticate. Reset the counter to 0 after the user successfully authenticates. </p>
    </li>
    <li>
      <p>
        <strong>Enforce the lockout policy.</strong> The lockout policy should be enforced at all points in the application where authentication is necessary. </p>
    </li>
    <li>
      <p>
        <strong>Set an unlocking mechanism.</strong> Keep track of the lockout period. Based on your application's lockout policy, unlock the account after the lockout period has expired.</p>
    </li>
  </ol>
  <h1>Secure Authentication Guidelines</h1>
  <ul>
    <li>
      <a href="/article/ab2ee2de-f811-433e-a1ec-f5f8e4704f9d">Centralize Authentication Controls</a>
    </li>
    <li>
      <a href="/article/31a08288-0750-4689-869f-2498be56eb4b">Require Authentication for All Sensitive Pages</a>
    </li>
    <li>
      <a href="/article/fdc4fd11-1675-4733-a041-e3d1eecbc201">Use Server-side Authentication</a>
    </li>
    <li>
      <a href="/article/8eba2142-4a6e-4f2c-9648-3ba1cadf9621">Force Reauthentication for Sensitive Operations</a>
    </li>
    <li>
      <a href="/article/322f3f59-a0bc-4056-9657-3d3ac2a60140">Log Authentication Events</a>
    </li>
    <li>
      <a href="/article/62593693-31c2-441a-b6f8-4fc47acac06d">Store Passwords Securely</a>
    </li>
    <li>
      <a href="/article/cc038844-f2c1-444c-b6cf-7cb5b423059f">Mask All Password Fields</a>
    </li>
    <li>
      <a href="/article/90ee4a94-47e5-4d8f-a576-632602861442">Lock Accounts After Multiple Failed Authentication Attempts</a>
    </li>
    <li>
      <a href="/article/fd83e67c-62b8-4cc3-a365-4491dd4a2ef6">Enforce Strong Password Requirements</a>
    </li>
    <li>
      <a href="/article/a3f48e53-b118-4180-8aa1-e945f1afadda">Force Password Renewal</a>
    </li>
    <li>
      <a href="/article/edd3e5fa-44a1-402a-820f-1860e9361fd1">Protect the Account Management Functions</a>
    </li>
    <li>
      <a href="/article/150e943f-6d59-42d6-bb0a-2cecf151dba1">Implement Authentication Controls to Fail Securely</a>
    </li>
  </ul>
  <h1>Secure Authentication Checklists</h1>
  <ul>
    <li>
      <a href="/article/6a2f9f21-3d59-4fba-b93e-1999807ff7d8">Authentication Controls Are Centralized</a>
    </li>
    <li>
      <a href="/article/0d20efdd-d9d8-42c7-99bc-e094d94f8d06">Authentication Is Required for All Sensitive Pages</a>
    </li>
    <li>
      <a href="/article/632c4d5a-04d9-4636-af27-17204442202e">Server-side Authentication Is Used</a>
    </li>
    <li>
      <a href="/article/0c6a261a-14e8-4c36-838d-17b4a8b6532c">Reauthentication Is Required for Sensitive Operations</a>
    </li>
    <li>
      <a href="/article/db6938c1-d962-449a-9d4f-3cc3776993c2">Authentication Events Are Logged</a>
    </li>
    <li>
      <a href="/article/3daed10e-b47a-40fe-b75d-3c68532c1f0d">Passwords Are Stored Securely</a>
    </li>
    <li>
      <a href="/article/2059bbc4-1ed3-4df7-9e76-feeb94a48bc7">All Password Fields Are Masked</a>
    </li>
    <li>
      <a href="/article/14a7c12b-46dd-4ee5-9ebf-8b9497ab7ce3">Accounts Are Locked After Multiple Failed Authentication Attempts</a>
    </li>
    <li>
      <a href="/article/696ff103-4793-4198-9322-aa7b275a04dc">Strong Password Requirements Are Enforced</a>
    </li>
    <li>
      <a href="/article/af1a2a69-bb4d-4ca4-86ab-174c4c5e3ca9">Password Renewal Is Enforced</a>
    </li>
    <li>
      <a href="/article/37e2ff71-71b6-47e0-b6f6-53c8d4e81544">The Account Management Functions Are Protected</a>
    </li>
    <li>
      <a href="/article/3e98ffe2-bb03-4cff-a7ea-2796ab6a833e">Authentication Controls Fail Securely</a>
    </li>
  </ul>]]></Data>
  </Content>
</TeamMentor_Article>