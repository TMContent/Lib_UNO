<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="0" Content_Hash="0">
  <Metadata>
    <Id>af2212a8-eb61-4575-9f6e-8987ce6ab7d5</Id>
    <Id_History>00000000-0000-0000-0000-00000076ad87,</Id_History>
    <Library_Id>7d2d0571-e542-45cd-9335-d7a0556c2bea</Library_Id>
    <Title>Explicitly State the Expected Origin with postMessage</Title>
    <Category>Web Messaging</Category>
    <Phase>Implementation</Phase>
    <Technology>HTML5</Technology>
    <Type>Guideline</Type>
    <DirectLink>Explicitly State the Expected Origin with postMessage</DirectLink>
    <Author />
    <Priority />
    <Status />
  </Metadata>
  <Content Sanitized="false" DataType="wikitext">
    <Data><![CDATA[==Applies To==

* HTML5

==What to Do==

Explicitly state the expected target origin as the second argument to //postMessage//.

==Why==

Explicitly state the expected target origin when using //postMessage// to make sure that only the intended site receives the data that is being sent. Using a specific target origin prevents malicious sites, or any site other than the one intended, from receiving the data in the message.

==How==

To explicitly state the expected target origin as the second argument to //postMessage//:

# **Identify all calls to //postMessage//.** Search the application code for references to the //postMessage// method. Create a spreadsheet to list all code that uses the //postMessage// method.
# **Define expected target origins.** In the spreadsheet, for each reference to the //postMessage// method, define what the expected target origin should be and add that information to the spreadsheet. If some kind of logic is required to compute the expected target origins, document all of that in the spreadsheet.
# **State the expected origin when calling //postMessage//.** For each piece of code that uses //postMessage//, specify the expected target origin as defined in the spreadsheet. If necessary, add code that calculates the expected target origin to be passed as the second argument to the //postMessage// method.

==Additional Resources==

* For more information about the //postMessage// method, see https://developer.mozilla.org/en-US/docs/Web/API/window.postMessage

==Web Messaging Guidelines==

* [[00000000-0000-0000-0000-00000012aada|Do Not Evaluate Messages as Code]]
* [[00000000-0000-0000-0000-00000010eb47|Use element.textContent to Assign Values to DOM Elements]]
* [[00000000-0000-0000-0000-00000076ad87|Explicitly State the Expected Origin with postMessage]]
* [[00000000-0000-0000-0000-0000006ab8ac|Validate Data Received by Event Handlers]]
* [[00000000-0000-0000-0000-00000085babd|Validate the Origin Attribute Against the FQDN]]
* [[00000000-0000-0000-0000-000000763637|Check The Origin Attribute of Messages]]

==Web Messaging Checklist Items==

* [[00000000-0000-0000-0000-0000008e9b8f|Messages Are Not Evaluated as Code]]
* [[00000000-0000-0000-0000-00000060fefb|Element.textContent Is Used to Assign Values to DOM Elements]]
* [[00000000-0000-0000-0000-0000004a4216|Expected Origin Is Explicitly Stated with postMessage]]
* [[967c9b95-2319-4741-a6fd-1b4bcdf3b636|Data Received by Event Handlers Is Validated]]
* [[16628f7f-e17a-4bd1-838a-011736bf0995|The Origin Attribute Is Validated Against the FQDN]]
* [[f103974e-3a42-4837-b04b-7da7e87c41ec|The Origin Attribute of Messages Is Checked]]
]]></Data>
  </Content>
</TeamMentor_Article>