<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="0" Content_Hash="0">
  <Metadata>
    <Id>dfcea588-85df-4645-b9dd-cf64c641e8d4</Id>
    <Id_History>00000000-0000-0000-0000-0000000a973e,</Id_History>
    <Library_Id>c037d0d2-0617-44f3-b846-21dc3d02c4f8</Library_Id>
    <Title>Cross-Site Request Forgery</Title>
    <Category>Input and Data Validation</Category>
    <Phase>Implementation</Phase>
    <Technology>PHP</Technology>
    <Type>Vulnerability</Type>
    <DirectLink>Cross-Site Request Forgery</DirectLink>
    <Author />
    <Priority />
    <Status />
  </Metadata>
  <Content Sanitized="false" DataType="wikitext">
    <Data><![CDATA[==Description==

A Cross Site Request Forgery (CSRF) attack occurs when an attacker tricks a victim into loading a page that contains a malicious request. This request may be able to change the state of the web application and is possible because the request is sent in the context of the logged in victim. For many sites each request automatically sends the victim's credentials such as the session cookie or authentication credentials. Due to this fact there is no way to distinguish the false request from a legitimate request. CSRF vulnerabilities affect web applications that allow authenticated users to perform operations that are not available to guest users. To prevent CSRF, include unique tokens in pages that invoke security sensitive operations. To check your application for CSRF, determine whether unique tokens are used in pages that carry out sensitive operations.

Cross Site Request Forgery attacks are known by other names including XSRF, Session Riding, One-Click and Zero-Click attacks. A One-Click attack refers to a link that causes a malicious action to be performed when a victim clicks on it. A Zero-Click attack is automatically executed upon page load. A common way to perform a zero-click attack is to embed the request in the source of an image. 

==Impact==

CSRF allows the attacker to carry out actions on the behalf of an authenticated user by tricking the user into visiting a malicious page or link. The exact impact depends on what functionality is vulnerable to CSRF. The attacker will usually try to add a privileged user account for himself or to inject arbitrary code into the application. If either of those scenarios succeeds, the attacker gains full control of the application.

==Countermeasures==

Implement all of the following countermeasures to protect your application against CSRF. 

* [[4236cf87-7f64-4f77-91b3-04dc1507c366|Include Unique Tokens in HTTP Requests]]
* [[8eba2142-4a6e-4f2c-9648-3ba1cadf9621|Force Reauthentication for Sensitive Operations]]

==Checklists==

Use each of the following checklist items to make sure that sufficient countermeasures against CSRF have been implemented. 

* [[bd341782-83db-4e9e-b604-e43b197ee256|Unique Tokens Are Included in HTTP Requests]]
* [[0c6a261a-14e8-4c36-838d-17b4a8b6532c|Reauthentication Is Required for Sensitive Operations]]

==Computer Based Training Links==

Use the following Computer Based Training courses to learn more about Cross-Site Request Forgery including techniques for remediation and prevention.

===Creating Secure PHP Code===

This course introduces best practices for developing secure PHP code. The course also identifies common PHP vulnerabilities that attackers can exploit to gain access to critical information. In addition, the course explains mitigation techniques that you can use to avoid common PHP vulnerabilities and write secure code. After completing this course, you will be able to describe the best practices for developing secure PHP code, explain common PHP vulnerabilities and learn mitigation techniques to avoid common PHP vulnerabilities and write secure code. 

For more information about CSRF in PHP applications, see screens 40-43 in [[http://teamprofessor.absorbtraining.com/ninja/#/courses/course/127620|COD 315 Creating Secure PHP Code]].

//Valid login credentials and enrollment in the course itself are required to access Team Professor content. If you need login credentials, please contact support@securityinnovation.com for help.//]]></Data>
  </Content>
</TeamMentor_Article>