<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="400964851" Content_Hash="1131462436">
  <Metadata>
    <Id>4d76c195-fa9a-4867-9adb-dd45ec20d4ca</Id>
    <Id_History>84177ac7-5973-4502-abe2-812ff300a368,</Id_History>
    <Library_Id>c4b9cb6a-4561-4451-9b6c-4e59d73584f6</Library_Id>
    <Title>Double Encoding Attack</Title>
    <Category>Input and Data Validation</Category>
    <Phase>Implementation</Phase>
    <Technology> Any</Technology>
    <Type>Attack</Type>
    <DirectLink>Double Encoding Attack</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>1</Priority>
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<br />
  <br />
  <h1>Applies To</h1>
  <p>All web applications.</p>
  <h1>Description</h1>
  <p>By doubly encoding input, an attacker may be able to bypass security checks that are only decoded once. The singly decoded input will pass security checks and allow the malicious input to be passed to backend servers where it will be fully decoded and interpreted as input.</p>
  <h1>Impact</h1>
  <ul>
    <li>
      <strong>Remote Code Execution</strong>: This attack is often used in conjunction with XSS or SQL injection to bypass security checks. <li><strong>Directory Traversal</strong>: by encoding '../' and variants, security checks may be bypassed and later interpreted by the server or file system allowing the attacker to access protected files.</li></li>
  </ul>
  <h1>Vulnerabilities</h1>
  <ul>
    <li>Failure to validate user input for encoded input. <li>Trusting data or failing to completely decode and check retrieved data from a shared data store.</li></li>
  </ul>
  <h1>Countermeasures</h1>
  <ul>
    <li>Constrain input: Use vigorous white-list style checking on any user input. <li>Fully decode: Ensure all input is fully decoded using methods at the backend server before operating on received data.</li></li>
  </ul>
  <h1>Example</h1>
  <p />
  <table>
    <tbody>
      <tr>
        <td>Malicious String</td>
        <td>Technology</td>
        <td>Single Encoded Version</td>
        <td>Double Encoded Version</td>
      </tr>
      <tr>
        <td>' (single quote)</td>
        <td>SQL</td>
        <td>&amp;#37;27</td>
        <td>&amp;#37;2527</td>
      </tr>
      <tr>
        <td>..\</td>
        <td>Directory Traversal</td>
        <td>&amp;#37;2E&amp;#37;2E&amp;#37;2F</td>
        <td>..&amp;#37;252F .. &amp;#37;&amp;#37;35c ..&amp;#37;&amp;#37;35&amp;#37;63 ..&amp;#37;25&amp;#37;35&amp;#37;63 ..etc </td>
      </tr>
      <tr>
        <td>alert("XSS")</td>
        <td>Javascript</td>
        <td>\u0061\u006C\u0065\u0072\u0074\u0028\u0022\u0058\u0053\u0053\u0022\u0029</td>
        <td>\u005C\u0075\u0030\u0030\u0036\u0031\u005C\u0075\u0030\u0030\u0036\u0043\u005C\u0075\u0030\u0030\u0036\u0035\u005C\u0075\u0030\u0030\u0037\u0032\u005C\u0075\u0030\u0030\u0037\u0034\u005C\u0075\u0030\u0030\u0032\u0038\u005C\u0075\u0030\u0030\u0032\u0032\u005C\u0075\u0030\u0030\u0035\u0038\u005C\u0075\u0030\u0030\u0035\u0033\u005C\u0075\u0030\u0030\u0035\u0033\u005C\u0075\u0030\u0030\u0032\u0032\u005C\u0075\u0030\u0030\u0032\u0039\u000A</td>
      </tr>
      <tr>
        <td>&lt;script&gt;gotcha&amp;#33;&lt;/script&gt;</td>
        <td>HTML</td>
        <td>&lt;script&lt;gotcha&amp;#33;&lt;/script&lt;</td>
        <td>&lt;script&gt;gotcha&amp;#33;&lt;/script&gt;</td>
      </tr>
    </tbody>
  </table>
  <h1>Additional Resources</h1>
  <ul>
    <li>For more information on web based encoding, see <a href="http://www.webreference.com/javascript/reference/core/ident.html">Writing Secure Code</a><li>For more information on URL encoding related attacks, see <a href="http://people.w3.org/rishida/scripts/uniview/conversion.php ">URL Encoded Attacks</a></li></li>
  </ul>
  <h1>Related Items</h1>
  <ul>
    <li>
      <a href="/article/5fc61d60-4afa-4f2e-80a5-05d7a656f3ac">Attack: Canonicalization Attack</a>
      <li>
        <a href="/article/e08f0f58-ccd3-4e52-8a43-51a4675d6119">Attack: AJAX Injection Attack</a>
        <li>
          <a href="/article/226cd058-712c-4c26-b760-3e7f32f06201">Attack: Command Injection Attack</a>
          <li>
            <a href="/article/80751518-9e6f-467f-83bc-33bac6b94ef5">Attack: Cross Site Scripting Attack</a>
            <li>
              <a href="/article/b1b9dcb6-97d0-4c70-b8ca-6fd1dbfbbc8b">Attack: File Name and Path Manipulation Attack</a>
              <li>
                <a href="/article/3e8414d9-58ae-4704-a102-eb7c6ef8ecce">Attack: Forceful Browsing Attack</a>
                <li>
                  <a href="/article/a89508a7-130f-4622-b167-10fdaeab5cf8">Attack: LDAP Injection Attack</a>
                  <li>
                    <a href="/article/eaa90597-a420-410b-a7e7-2527dba65649">Attack: Server-Side Code Injection Attack</a>
                    <li>
                      <a href="/article/5c86d31c-18bf-45e8-9fd1-9214a285022e">Attack: SQL Injection Attack</a>
                      <li>
                        <a href="/article/d2cd0955-4493-48de-81aa-c46f681fad0a">Attack: XML Injection Attack</a>
                        <li>
                          <a href="/article/5aae21ac-2eb3-4f3d-ab10-ce31e490a261">Attack: Information Disclosure Attack</a>
                          <li>
                            <a href="/article/946a5edb-e8f8-4365-8675-b8a5032c201b">Guideline: Validate All Data Passed Between Native and Java Code </a>
                            <li>
                              <a href="/article/88f49e05-f101-4764-b8e3-b31cd7507071">Guideline: Do Not Rely on Request Validation </a>
                              <li>
                                <a href="/article/40eea61e-c8bd-494a-b75d-c18c2074c752">Guideline: Validate Input from All Sources </a>
                                <li>
                                  <a href="/article/f29fac90-c626-41d6-9184-acd6007696cf">Guideline: Validate Input for Length, Range, Format, and Type </a>
                                  <li>
                                    <a href="/article/9f21442f-2aee-4573-8be6-a5b51d9c89b8">Guideline: Do Not Rely on Client-Side Validation </a>
                                    <li>
                                      <a href="/article/ce899ba6-8ae2-4494-8706-ce863fae58e7">Guideline: Filter All User-Supplied Filename and Path Input </a>
                                    </li>
                                  </li>
                                </li>
                              </li>
                            </li>
                          </li>
                        </li>
                      </li>
                    </li>
                  </li>
                </li>
              </li>
            </li>
          </li>
        </li>
      </li>
    </li>
  </ul>]]></Data>
  </Content>
</TeamMentor_Article>