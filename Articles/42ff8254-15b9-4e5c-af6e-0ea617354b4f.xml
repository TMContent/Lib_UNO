<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="0" Content_Hash="0">
  <Metadata>
    <Id>42ff8254-15b9-4e5c-af6e-0ea617354b4f</Id>
    <Id_History>42ff8254-15b9-4e5c-af6e-0ea617354b4f,3c9ece03-4a8c-4fe7-a827-96e30b3d1216,</Id_History>
    <Library_Id>be5273b1-d682-4361-99d9-6234f2d47eb7</Library_Id>
    <Title>[1612Dupe] Indirect Object References Are Used</Title>
    <Category>Authorization</Category>
    <Phase>Design</Phase>
    <Technology>Scala Play</Technology>
    <Type>Checklist Item</Type>
    <DirectLink>Indirect Object References Are Used</DirectLink>
    <Tag />
    <Author />
    <Priority />
    <Status />
  </Metadata>
  <Content Sanitized="false" DataType="html">
    <Data><![CDATA[<h1>Applies to<br /></h1>
  <p>Scala and Play Framework 2.1.0+<br /></p>
  <h1>What to Check For</h1>
  <p>Verify that per-user or per-session indirect object references are used instead of direct object references.</p>
  <h1>Why</h1>
  <p>Direct object references often expose sensitive data, such as files, database entries, or personal information. Direct object reference attacks are very simple to execute and have been used in high profile, low-skill attacks. Indirect object references help prevent direct object reference vulnerabilities. <br /></p>
  <p>Note that another approach to mitigating direct object reference vulnerabilities is to perform access control checks whenever accessing objects.</p>
  <h1>How to Check</h1>
  <p>To verify that indirect object references are used:</p>
  <ol>
    <li>
      <p>
        <strong>Identify pages that use object references.</strong>&amp;nbsp;Make a list of all pages in the application. Examine each page to identify the pages that use object references.</p>
    </li>
    <li>
      <p>
        <strong>Verify that indirect object references are used.</strong>&amp;nbsp;Examine each page that uses object references to make sure that indirect object references are used instead of direct object references.</p>
    </li>
  </ol>
  <h1>How to Fix</h1>
  <p>To use indirect object references:</p>
  <ol>
    <li>
      <p>
        <strong>Identify pages that use direct object references.</strong>&amp;nbsp;Make a list of all pages in the application. Examine each page to identify the pages that use direct object references.</p>
    </li>
    <li>
      <p>
        <strong>Identify objects that are being referenced.</strong>&amp;nbsp;For each page that uses direct object references, make a list of all objects that are being referenced.</p>
    </li>
    <li>
      <p>
        <strong>Consider alternatives.</strong>&amp;nbsp;Using indirect object references may require significant changes to the application. Consider not using object references; this requires replacing all code that performs object references. Or, perform access control checks each time an object is referenced; this requires adding code that performs access control checks to code that performs object references.</p>
    </li>
    <li>
      <p>
        <strong>Define object reference maps.</strong>&amp;nbsp;Object reference maps are arrays or hashes of objects that are being referenced. The web application exposes the index of the array or the key of the hash that matches the required resource, rather than exposing the object itself. This approach ensures that only objects in the array may be accessed. For this approach to work, reference maps should only include objects for which access is authorized. It is possible to use per-user or per-session object mappings. Per-user mappings define objects that may be accessed by each user. Per-session mappings define objects that may be accessed by each user for the current session. Per-session references may offer additional security or flexibility, but require more work. Mappings should be generated dynamically and that means that code has to be written that defines objects that may be accessed by each user.</p>
    </li>
    <li>
      <p>
        <strong>Update pages to use reference maps instead of direct object references.</strong> Once the object reference maps are defined, update all the pages that reference objects to use the reference maps.</p>
    </li>
  </ol>
  <h1>Additional Resources</h1>
  <ul>
    <li>For more information about preventing insecure direct object reference vulnerabilities, please see&amp;nbsp;<a href="http://www.enterprisenetworkingplanet.com/netsecur/article.php/3927401/Protect-Your-Web-Apps-From-Insecure-Direct-Object-References.htm">http://www.enterprisenetworkingplanet.com/netsecur/article.php/3927401/Protect-Your-Web-Apps-From-Insecure-Direct-Object-References.htm</a></li>
    <li>For information about using access reference maps in OWASP ESAPI, please see&amp;nbsp;<a href="http://owasp-esapi-java.googlecode.com/svn/trunk_doc/latest/org/owasp/esapi/AccessReferenceMap.html">http://owasp-esapi-java.googlecode.com/svn/trunk_doc/latest/org/owasp/esapi/AccessReferenceMap.html</a></li>
  </ul>
  <div>
    <br />
  </div>]]></Data>
  </Content>
</TeamMentor_Article>