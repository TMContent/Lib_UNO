<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="0" Content_Hash="0">
  <Metadata>
    <Id>7f63f961-2551-43c5-b141-84cb1c1e235b</Id>
    <Id_History>fde877ec-f539-4ce4-8cd3-d3b7da1e1ecb,</Id_History>
    <Library_Id>d9c2b53f-5b05-4152-be72-e79d72854707</Library_Id>
    <Title>Authentication And Authorization Are Required for All Sensitive Pages</Title>
    <Category>Authorization</Category>
    <Phase>Design</Phase>
    <Technology>Scala with Play Framework</Technology>
    <Type>Checklist Item</Type>
    <DirectLink>Authentication And Authorization Are Required for All Sensitive Pages</DirectLink>
    <Author />
    <Priority />
    <Status />
  </Metadata>
  <Content Sanitized="false" DataType="html">
    <Data><![CDATA[<h1>Applies to</h1>
  <p />Scala and Play Framework 2.1.0+<p /><h1>What to Check For</h1><p>Verify that authentication and authorization are required for all sensitive pages.</p><h1>Why</h1><p>All pages that have private information should require authentication and authorization to prevent unauthorized information disclosure. Use role-based authorization policies because they are relatively simple to manage correctly.</p><h1>How to Check</h1><p>To verify that authentication and authorization are required for all sensitive pages:</p><ol><li><p><strong>Identify all sensitive pages.</strong>&amp;nbsp;Make a list of all pages that handle sensitive or private information.</p></li><li><p><strong>Verify that all sensitive pages require authentication.</strong>&amp;nbsp;Visit each sensitive page with a web browser to make sure it requires authentication.</p></li><li><p><strong>Verify that all sensitive pages require authorization.</strong>&amp;nbsp;Make a list of all available roles for testing role-based authorization. Visit each sensitive page authenticated as a member of each role to verify that authorization is implemented correctly.</p></li><li><p><strong>(Optional) Verify that authentication and authorization are implemented on the server correctly.</strong>&amp;nbsp;The goal of this checklist is to verify that all sensitive pages are covered by authentication and authorization controls. If additional assurance is required, it may be helpful to review the application in depth. To do so: identify authentication and authorization libraries being used, verify that the web application server is configured correctly for the chosen authentication and authorization methods and that all sensitive pages are covered, review each sensitive page to make sure authentication and authorization features are used correctly, and review code used by each sensitive page to make sure that it uses authentication and authorization correctly. These tasks may be quite time consuming and may not be necessary to verify that all sensitive pages are protected by the authentication and authorization controls.</p></li></ol><h1>How to Fix</h1><p>To require authentication and authorization for all sensitive pages:</p><ol><li><p><strong>Identify all sensitive pages.</strong>&amp;nbsp;Make a list of all pages that handle sensitive or private information.</p></li><li><p><strong>Define roles.</strong>&amp;nbsp;Define access roles for your application. These roles should include administrative users and various types of users specific to your application.</p></li><li><p><strong>Implement authentication and role-based access control.</strong>&amp;nbsp;<strong>&amp;nbsp;</strong>In Play framework 2.1.0+, you can use<a href="https://github.com/schaloner/deadbolt-2"> DeadBolt-2</a> as an authorization system that defines the access rights to certain controller methods or parts of a view. You can use <a href="https://github.com/jaliss/securesocial">SecureSocial</a> to verify the authorization of the logged in user to access the restricted section/URL of the website.&amp;nbsp;</p><p>Make sure that the user is authorized to access the page before granting him access. When using a critical resource such as a configuration file, check to see if the resource has insecure permissions (such as being modifiable by any regular user), and generate an error or even exit the software if there is a possibility that the resource could have been modified by an unauthorized party. For this, make use of an Access Control Library such as&amp;nbsp;<a href="https://www.owasp.org/index.php/ESAPI_Access_Control">OWASP ESAPI Access Control</a>.&amp;nbsp;</p></li></ol><h1 style="margin: 0px; padding: 10px 0px 0px; font-size: 17px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255);">Authorization Guidelines</h1><ul style="margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; background-color: rgb(255, 255, 255);"><li style="margin: 0px; padding: 0px;"><b style="margin: 0px; padding: 0px;"><a href="b7176093-9004-4b9f-8b6b-4a56c6e9cb87" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Require Authentication and Authorization for All Sensitive Pages</a></b></li><li style="margin: 0px; padding: 0px;"><b style="margin: 0px; padding: 0px;"><a href="08b369bf-b2ff-47e1-92c7-11c8607fbe00" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Make Authentication and Authorization Policies Configurable</a></b></li><li style="margin: 0px; padding: 0px;"><b style="margin: 0px; padding: 0px;"><a href="10a459c4-4a39-4325-b3a9-a3458ac43b0c" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Deny All Access by Default</a></b></li><li style="margin: 0px; padding: 0px;"><b style="margin: 0px; padding: 0px;"><a href="be7b255c-ce4b-427b-8b02-66e78481179e" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Check Access Control Permissions When Referencing Objects</a></b></li><li style="margin: 0px; padding: 0px;"><b style="margin: 0px; padding: 0px;"><a href="0cdb8ff4-a9f0-47d8-b32c-b72e2da858d9" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Use Indirect Object References</a></b></li><li style="margin: 0px; padding: 0px;"><b style="margin: 0px; padding: 0px;"><a href="42892132-de71-41b9-8c35-8f8ee23cb758" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Partition the Application Between Public and Private Domains</a></b></li><li style="margin: 0px; padding: 0px;"><b style="margin: 0px; padding: 0px;"><a href="52ea4336-7d99-47b3-bea2-2ac33da6e1a2" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Secure the Account Administration Functionality</a></b></li><li style="margin: 0px; padding: 0px;"><b style="margin: 0px; padding: 0px;"><a href="4a62104f-8abf-4d1f-8959-04b59b6db3b4" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Automatically Lock Inactive User Accounts</a></b></li></ul><h1 style="margin: 0px; padding: 10px 0px 0px; font-size: 17px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255);">Authorization Checklists</h1><ul style="margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; background-color: rgb(255, 255, 255);"><li style="margin: 0px; padding: 0px;"><b style="margin: 0px; padding: 0px;"><a href="001453f0-a647-4307-ad94-4077307f71a1" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Authentication and Authorization Are Required for All Sensitive Pages</a></b></li><li style="margin: 0px; padding: 0px;"><b style="margin: 0px; padding: 0px;"><a href="a1310a50-1c9f-49f1-ad3e-ae1002e51b00" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Authentication and Authorization Policies Are Configurable</a></b></li><li style="margin: 0px; padding: 0px;"><b style="margin: 0px; padding: 0px;"><a href="e118152a-8a32-455d-b8ee-4b5d4c66742e" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">All Access Is Denied by Default</a></b></li><li style="margin: 0px; padding: 0px;"><b style="margin: 0px; padding: 0px;"><a href="b01e90c6-bf52-4db8-b2ce-2b5a89a40815" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Access Control Permissions Are Checked When Referencing Objects</a></b></li><li style="margin: 0px; padding: 0px;"><b style="margin: 0px; padding: 0px;"><a href="42ff8254-15b9-4e5c-af6e-0ea617354b4f" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Indirect Object References Are Used</a></b></li><li style="margin: 0px; padding: 0px;"><b style="margin: 0px; padding: 0px;"><a href="41a04d3f-0bb5-4904-bb28-134a109f9ce0" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">The Application Is Partitioned into Public and Private Domains</a></b></li><li style="margin: 0px; padding: 0px;"><b style="margin: 0px; padding: 0px;"><a href="02b0be6c-99ed-4ff6-8805-8fc0a7402ae5" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Account Administration Functionality Is Secured</a></b></li><li style="margin: 0px; padding: 0px;"><b style="margin: 0px; padding: 0px;"><a href="1a839a80-f801-4bcd-895b-a62cddac93bc" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Inactive User Accounts Are Automatically Locked</a></b></li></ul>]]></Data>
  </Content>
</TeamMentor_Article>