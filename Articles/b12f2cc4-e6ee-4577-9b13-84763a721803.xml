<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="0" Content_Hash="0">
  <Metadata>
    <Id>b12f2cc4-e6ee-4577-9b13-84763a721803</Id>
    <Id_History>b12f2cc4-e6ee-4577-9b13-84763a721803,c64deab4-9d99-4130-abfc-5159fbab08e6,</Id_History>
    <Library_Id>d9c2b53f-5b05-4152-be72-e79d72854707</Library_Id>
    <Title>Calculate Destinations of Redirects And Forwards Without User Input</Title>
    <Category>Redirects and Forwards</Category>
    <Phase>Design</Phase>
    <Technology>Scala with Play Framework</Technology>
    <Type>Guideline</Type>
    <DirectLink>Calculate Destinations of Redirects And Forwards Without User Input</DirectLink>
    <Author />
    <Priority />
    <Status />
  </Metadata>
  <Content Sanitized="false" DataType="html">
    <Data><![CDATA[<h1>Applies to</h1>
  <p>Scala and Play Framework 2.1.0+</p>
  <h1>What to Do</h1>
  <p>Calculate destinations of redirects and forwards without user input, if possible.</p>
  <h1>Why</h1>
  <p>Using input to calculate destinations of redirects or forwards may allow an attacker to create hyperlinks that appears to point to legitimate sites but redirect to malicious pages controlled by the attacker. This technique is often used by phishers to trick people into visiting fake sites that steal authentication credentials.</p>
  <h1>When</h1>
  <p>Use this guideline when writing a web application that uses redirects or forwards. Avoid using redirects or forwards in web applications, if possible.</p>
  <h1>How</h1>
  <p>Perform the following actions to calculate destinations of redirects and forwards without user input:</p>
  <ol>
    <li>
      <p>
        <strong>Find redirects and forwards.</strong>&amp;nbsp;Find all pages that perform redirects or forwards.</p>
    </li>
    <li>
      <p>
        <strong>Identify dangerous redirects and forwards.</strong>&amp;nbsp;Find all redirects and forwards that rely on user input to calculate their destinations.</p>
    </li>
    <li>
      <p>
        <strong>Rewrite redirects and forwards.</strong>&amp;nbsp;Consider making design or code changes to get rid of each redirect or forward, if possible. If a redirect or forward is absolutely necessary, consider how it may be rewritten to operate without user input. This is usually possible based on assumptions made in the application design.</p>
    </li>
  </ol>
  <h1 style="margin: 0px; padding: 10px 0px 0px; font-size: 17px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255);">Redirects and Forwards Guidelines</h1>
  <ul style="margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; background-color: rgb(255, 255, 255);">
    <li style="margin: 0px; padding: 0px;">
      <b>
        <a href="b12f2cc4-e6ee-4577-9b13-84763a721803">Calculate Destinations of Redirects and Forwards Without User Input</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b>
        <a href="353bbdfb-3d1e-494f-978c-e581f128ed4a">Use Mapping Values When Redirecting on User Input</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b>
        <a href="a9d0919d-9630-4cce-87b0-5861662dfd2a">Validate Destinations of Redirects and Forwards</a>
      </b>
    </li>
  </ul>
  <h1 style="margin: 0px; padding: 10px 0px 0px; font-size: 17px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255);">Redirects and Forwards Checklists</h1>
  <ul style="margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; background-color: rgb(255, 255, 255);">
    <li style="margin: 0px; padding: 0px;">
      <b>
        <a href="3df8ba30-ea80-426f-b30a-5737a601a206">Redirects and Forwards Are Not Used Unless Necessary</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b>
        <a href="29aab3c9-027a-4d80-9963-79ea6077a61d">Destinations of Redirects and Forwards Are Calculated Without User Input</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b>
        <a href="1a4d7984-11a7-4d95-9c48-3d44cc22800b">Mapping Values Are Used for Redirects and Forwards</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b>
        <a href="3e73a590-557d-49d8-be77-09fdea2cb64c">Destinations of Redirects and Forwards Are Validated</a>
      </b>
    </li>
  </ul>]]></Data>
  </Content>
</TeamMentor_Article>