<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="0" Content_Hash="0">
  <Metadata>
    <Id>4204b854-e5e9-48a2-86f3-4324865a74a4</Id>
    <Id_History>c4759c09-8ecc-46e1-a900-8bc4b55801d6,</Id_History>
    <Library_Id>d9c2b53f-5b05-4152-be72-e79d72854707</Library_Id>
    <Title>Broken Authentication and Session Management</Title>
    <Category>OWASP</Category>
    <Phase>Any</Phase>
    <Technology>Scala with Play Framework</Technology>
    <Type>Vulnerability</Type>
    <DirectLink>Broken Authentication and Session Management</DirectLink>
    <Author />
    <Priority />
    <Status />
  </Metadata>
  <Content Sanitized="false" DataType="html">
    <Data><![CDATA[<h2 style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 15px; margin: 0px; padding: 0px; color: rgb(17, 17, 17);">Description</h2>
  <p style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; margin: 0.5em 0px 1em; padding: 0px; line-height: 1.5em; color: rgb(17, 17, 17);">Proper authentication and session management are essential for every application. If credentials and session tokens are not stored and managed properly, and if registration, password-reset, and account-update features are not designed securely,&amp;nbsp; the strongest of authentication mechanisms can fail. <br /></p>
  <p style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; margin: 0.5em 0px 1em; padding: 0px; line-height: 1.5em; color: rgb(17, 17, 17);">In any application, cookies are used to maintain a session. If session cookies are not random and cryptographically strong, the chance of a session hijack is high. The attacker can steal the session cookie and&amp;nbsp; replay it via another user to can gain access to a valid session.</p>
  <h2 style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 15px; margin: 0px; padding: 0px; color: rgb(17, 17, 17);">Impact</h2>
  <p style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; margin: 0.5em 0px 1em; padding: 0px; line-height: 1.5em; color: rgb(17, 17, 17);">If authentication and session management is flawed, an attacker can steal the session cookie to gain access to a valid user session.</p>
  <h2 style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 15px; margin: 0px; padding: 0px; color: rgb(17, 17, 17);">Countermeasures</h2>
  <p>Play Framework is stateless. The session used to identify the client is stored on the client as a cookie using <font face="Courier New">'session.put(“key”,“value”)'</font>. The cookie is signed with the application secret which is stored in the <font face="Courier New">conf/application.conf.</font> If there is a change in the content of a cookie sent with a request, the signature will not match and Play will automatically ignore the request, thus preventing session tampering.</p>
  <p>Additional countermeasures to safeguard against session hijacking and other session-related threats are:</p>
  <p />
  <ol>
    <li>Do not commit the application secret in a public repository.</li>
    <li>When you install an application written by someone else, change the secret key to your own using the command&amp;nbsp; <font face="Courier New">play secret</font>.</li>
    <li>Since the cookie is not encrypted, do not store critical data in the session. It can be seen by looking at the user cookie, by sniffing the connection on a local network, or over wifi. Some ways to make it more difficult to see are:</li>
  </ol>
  <blockquote>
    <ul>
      <li>Set the cookie attributes properly.</li>
      <li>Set the cookie domain using&amp;nbsp; <font face="Courier New">application.defaultCookieDomain=.example.com</font>&amp;nbsp; in the&amp;nbsp; <font face="Courier New">application.conf&amp;nbsp;</font> file.</li>
      <li>Enable the&amp;nbsp; <font face="Courier New">HTTPOnly</font>&amp;nbsp; flag using&amp;nbsp; <font face="Courier New">application.session.httpOnly=true</font>&amp;nbsp; in the&amp;nbsp; <font face="Courier New">application.conf</font>&amp;nbsp; file.</li>
      <li>Set a session maximum age using&amp;nbsp; <font face="Courier New">application.session.maxAge=value</font> &amp;nbsp; in the&amp;nbsp; <font face="Courier New">application.conf</font> &amp;nbsp; file. <br /></li>
      <li>Enable the&amp;nbsp; <font face="Courier New">Secure</font>&amp;nbsp; flag on the cookie using&amp;nbsp;&amp;nbsp; <font face="Courier New">application.session.secure=true</font> &amp;nbsp; in the&amp;nbsp;&amp;nbsp; <font face="Courier New">application.conf</font> &amp;nbsp; file.</li>
      <li>Set the application to send the cookie only if cookie was not tampered using “application.session.sendOnlyIfChanged=true” in the “application.conf” file.</li>
      <li>Ensure that authentication tokens are <i>always</i> sent via a proper SSL connection. <br /></li>
    </ul>
  </blockquote>
  <p />
  <p style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; margin: 0.5em 0px 1em; padding: 0px; line-height: 1.5em; color: rgb(17, 17, 17);">Note: Before adding any new cookie, thoroughly discuss the attributes of the cookie and select the most optimum settings for the cookie.</p>
  <p style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; margin: 0.5em 0px 1em; padding: 0px; line-height: 1.5em; color: rgb(17, 17, 17);">
    <span style="line-height: 1.5em;">Refer to the following Guidelines to help implement proper authentication mechanisms:</span>
  </p>
  <ul style="margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; background-color: rgb(255, 255, 255);">
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="452eaf9a-e3e9-4d9e-ac3e-0f435af837a1" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Centralize Authentication Controls</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="ceb2d5c2-fa01-4fc3-bb5a-3cd14c4cf604" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Use Server-side Authentication</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="f2f4b099-d01d-4d93-96a2-93ba6e5d085a" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Make Sure Authentication Controls Fail Securely</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="479b9ff4-f0fb-4870-8929-8b63b2b7d0b3" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Force Re-authentication When Executing Critical Functionality</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="ba64e4ba-9d14-4054-a99e-b6594f9698d6" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Validate Usernames Before Processing Them</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="57f0990c-06b9-4f94-ac1e-063773c7988d" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Lock Accounts After Consecutive Failed Login Attempts</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="6d74a22d-31d2-4584-9d93-85687ea4a637" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Enforce Strong Passwords</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="9d80865a-ddc8-49bd-be15-0f17a0e34383" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Force Password Renewal</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="15e9d2b8-445b-4163-88f8-a705e14a5804" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Mask All Password Fields</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="5534db32-d558-4e7a-af11-f11e0829c41a" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Place Logout Links on All Pages that Require Authentication</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="3142c504-e433-4f9b-bd54-28a11e04877d" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Consider Using Two Factor Authentication</a>
      </b>
    </li>
  </ul>
  <div>
    <font face="Segoe UI, Helvetica Neue, Helvetica, Arial, sans-serif" size="2">
      <br />
    </font>
  </div>
  <div>
    <font face="Segoe UI, Helvetica Neue, Helvetica, Arial, sans-serif" size="2">
      <span style="line-height: 1.5em;">Refer to the following Guidelines to help implement proper authorization mechanisms</span>:</font>
  </div>
  <div>
    <ul style="margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; background-color: rgb(255, 255, 255);">
      <li style="margin: 0px; padding: 0px;">
        <b style="margin: 0px; padding: 0px;">
          <a href="b7176093-9004-4b9f-8b6b-4a56c6e9cb87" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Require Authentication and Authorization for All Sensitive Pages</a>
        </b>
      </li>
      <li style="margin: 0px; padding: 0px;">
        <b style="margin: 0px; padding: 0px;">
          <a href="08b369bf-b2ff-47e1-92c7-11c8607fbe00" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Make Authentication and Authorization Policies Configurable</a>
        </b>
      </li>
      <li style="margin: 0px; padding: 0px;">
        <b style="margin: 0px; padding: 0px;">
          <a href="10a459c4-4a39-4325-b3a9-a3458ac43b0c" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Deny All Access by Default</a>
        </b>
      </li>
      <li style="margin: 0px; padding: 0px;">
        <b style="margin: 0px; padding: 0px;">
          <a href="be7b255c-ce4b-427b-8b02-66e78481179e" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Check Access Control Permissions When Referencing Objects</a>
        </b>
      </li>
      <li style="margin: 0px; padding: 0px;">
        <b style="margin: 0px; padding: 0px;">
          <a href="0cdb8ff4-a9f0-47d8-b32c-b72e2da858d9" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Use Indirect Object References</a>
        </b>
      </li>
      <li style="margin: 0px; padding: 0px;">
        <b style="margin: 0px; padding: 0px;">
          <a href="42892132-de71-41b9-8c35-8f8ee23cb758" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Partition the Application Between Public and Private Domains</a>
        </b>
      </li>
      <li style="margin: 0px; padding: 0px;">
        <b style="margin: 0px; padding: 0px;">
          <a href="52ea4336-7d99-47b3-bea2-2ac33da6e1a2" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Secure the Account Administration Functionality</a>
        </b>
      </li>
      <li style="margin: 0px; padding: 0px;">
        <b style="margin: 0px; padding: 0px;">
          <a href="4a62104f-8abf-4d1f-8959-04b59b6db3b4" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Automatically Lock Inactive User Accounts</a>
        </b>
      </li>
    </ul>
  </div>
  <div>
    <font face="Segoe UI, Helvetica Neue, Helvetica, Arial, sans-serif" size="2">
      <br />
    </font>
  </div>
  <ul style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; color: rgb(17, 17, 17);">
  </ul>
  <h2 style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 15px; margin: 0px; padding: 0px; color: rgb(17, 17, 17);">Application Check</h2>
  <p style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; margin: 0.5em 0px 1em; padding: 0px; line-height: 1.5em; color: rgb(17, 17, 17);">To check for adequate protection against this vulnerability, refer to the following Checklist Items:<span class="Apple-tab-span" style="white-space: pre;"></span></p>
  <ul style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; color: rgb(17, 17, 17); background-color: rgb(255, 255, 255);">
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="452eaf9a-e3e9-4d9e-ac3e-0f435af837a1" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Authentication Controls Are Centralized</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="6d6ecd62-253b-47b1-84a4-f9e112ee3623" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Server-side Authentication Is Used</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="a4e8cb3e-1bd0-474f-853a-4226a4354262" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Authentication Controls Fail Securely</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="fbb4cdda-8c2e-4099-8e57-e4a9c491775f" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Re-authentication Is Enforced When Executing Critical Functionality</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="33fb64e2-51e1-499e-adde-8ac5bae15b26" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Usernames Are Validated Before Use</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="40ed1ed0-8081-4675-9e8e-8b83ffbfd7b9" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Accounts Are Locked After Consecutive Failed Login Attempts</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="2643951d-7530-4c34-a4a9-3111095dedb6" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Strong Passwords Are Enforced</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="5381c4aa-09b2-44f0-bae5-32b9d0230420" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Password Renewal Is Enforced</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="bfadd27f-8ade-45cb-8b3d-6e53ff319ed8" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">All Password Fields Are Masked</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="9dbf9073-871e-4614-9fbf-5b542226d211" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">All Pages that Use Authentication Have Logout Links</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="acf6c265-cd3a-470f-bd85-24b1907d3eb1" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Access to the Credential Store Is Limited</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="001453f0-a647-4307-ad94-4077307f71a1" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Authentication and Authorization Are Required for All Sensitive Pages</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="a1310a50-1c9f-49f1-ad3e-ae1002e51b00" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Authentication and Authorization Policies Are Configurable</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="e118152a-8a32-455d-b8ee-4b5d4c66742e" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">All Access Is Denied by Default</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="b01e90c6-bf52-4db8-b2ce-2b5a89a40815" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Access Control Permissions Are Checked When Referencing Objects</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="42ff8254-15b9-4e5c-af6e-0ea617354b4f" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Indirect Object References Are Used</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="41a04d3f-0bb5-4904-bb28-134a109f9ce0" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">The Application Is Partitioned into Public and Private Domains</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="02b0be6c-99ed-4ff6-8805-8fc0a7402ae5" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Account Administration Functionality Is Secured</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="1a839a80-f801-4bcd-895b-a62cddac93bc" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Inactive User Accounts Are Automatically Locked</a>
      </b>
    </li>
  </ul>
  <div>
    <font color="#111111" face="Segoe UI, Helvetica Neue, Helvetica, Arial, sans-serif" size="2">
      <br />
    </font>
  </div>
  <ul style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; color: rgb(17, 17, 17);">
  </ul>
  <h2 style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 15px; margin: 0px; padding: 0px; color: rgb(17, 17, 17);">Web-Based Training</h2>
  <p style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; margin: 0.5em 0px 1em; padding: 0px; line-height: 1.5em; color: rgb(17, 17, 17);">
    <a href="https://vulnerabilities.teammentor.net/article/279ad567-2b34-44ce-8e56-8d96770ba500" style="margin: 0px; padding: 0px; color: rgb(51, 51, 153); font-weight: bold;">AWA 101 Fundamentals of Application Security</a>
  </p>
  <p style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; margin: 0.5em 0px 1em; padding: 0px; line-height: 1.5em; color: rgb(17, 17, 17);">This two-part course is ideal for security and development practitioners that want to understand software security risk and seek specific implementation guidance on how to build and deploy more secure software applications. It starts off describing why software security is critical and the risk that software vulnerabilities represent, and proceeds to lay the foundation for secure software development by presenting specific security controls and principles that development teams can implement immediately to reduce software risk.</p>
  <h2 style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 15px; margin: 0px; padding: 0px; color: rgb(17, 17, 17);">Additional Resources</h2>
  <ul style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; color: rgb(17, 17, 17);">
    <li style="margin: 0px; padding: 0px;">For more information about Broken Authentication and Session Management:&amp;nbsp;<a href="https://www.owasp.org/index.php/Broken_Authentication_and_Session_Management">https://www.owasp.org/index.php/Broken_Authentication_and_Session_Management</a></li>
  </ul>
  <p>
    <br />
  </p>
  <ul style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; color: rgb(17, 17, 17);">
  </ul>]]></Data>
  </Content>
</TeamMentor_Article>