<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="0" Content_Hash="0">
  <Metadata>
    <Id>11a15f3a-7fe8-4e4c-be5e-309ab7227b3d</Id>
    <Library_Id>be5273b1-d682-4361-99d9-6234f2d47eb7</Library_Id>
    <Title>Validate All Input</Title>
    <Category />
    <Phase>Implementation</Phase>
    <Technology>Technology Independent</Technology>
    <Type>Guideline</Type>
    <DirectLink />
    <Tag />
    <Author />
    <Priority />
    <Status />
  </Metadata>
  <Content Sanitized="false" DataType="markdown">
    <Data><![CDATA[## Applies To ##

* All applications
* All system types

## What to Do ##

Validate all untrusted input using whitelist/positive input validation. Whitelist input validation allows only input that is explicitly defined as valid, as opposed to blacklist input validation, which filters out known bad input. Identify all types of input handled by the application and determine the valid format for each type, then add checks in code to make sure the data is valid before processing it.

## Why ##

Properly implemented input validation mitigates many types of injection vulnerabilities, such as Cross-Site Scripting and SQL injection. For native code applications, input validation can also mitigate memory management issues, such as Buffer Overflows.

## How ##

To validate all untrusted input using whitelist input validation:

1. **Identify all entry points for untrusted input.** Make a list of all possible sources of untrusted input in your application. For a web application, this includes: form fields, request parameters, cookies, headers, files and databases. For a rich client or a mobile application, this includes: keyboard input, files, databases and network connections. 

2. **Identify all types of input accepted by the application.** For each source of untrusted input on the list, define valid characters, length, format, and range (for numerical values).

3. **Define an input validation subsystem.** Define a set of validator functions to validate each type of input handled by the application. Input has to be validated on the server for client-server applications; it can be validated on the client-side as well, but not instead of on the server.

4. **(All input) Validate length.** Add code to all validators to check that the length of the untrusted input is valid. Checking length before using regular expressions helps prevent regular expression Denial-of-Service attacks.

5. **(Text input) Validate characters.** Add code to validators that handle text input to restrict the acceptable range of characters in text input using regular expressions.

6. **(Structured input) Validate format.** For validators that handle input that has a specific pattern, such as a date or a phone number, use regular expressions to make sure untrusted input matches the input type specified by the application. 

7. **(Numeric input) Validate range.** For validators for numeric input, add code to restrict the acceptable range of numerical input by comparing the input to the maximum and minimum acceptable values.

8. **(Optional) Reject and respond to known bad input.** This step does not add much actual security, but it might provide defense in depth. The input validation subsystem can check for known attack strings and respond to these likely attacks by doing things like logging detailed attacker information, alerting the administrator, blocking the attacker's IP address for some time, and displaying an error message to the attacker. 

9. **(Context-sensitive) Encode input.** If the input is going to be displayed back through a web browser, consider encoding it to prevent Cross-Site Scripting attacks before processing or storing it. Be careful not to introduce double-encoding issues by encoding this data again elsewhere in the code.


## Related Pages ##

* [.NET - Validate All Input](3de41277-0cc1-4ebc-8dd7-e96d161aa0ef)
* [Ruby - Anchor Regular Expressions Using \A and \z](15aa6cfc-9e95-44a6-8e6f-25bc2fac7911)


## Additional Resources ##

* For more information on input validation, see [https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet](https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet)]]></Data>
  </Content>
</TeamMentor_Article>