<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="0" Content_Hash="0">
  <Metadata>
    <Id>0b3fab5c-3212-484a-a49f-fae305041556</Id>
    <Id_History>8b7724de-7046-4458-8b82-ff33f013b724,</Id_History>
    <Library_Id>d9c2b53f-5b05-4152-be72-e79d72854707</Library_Id>
    <Title>Insecure Cryptographic Storage</Title>
    <Category>OWASP</Category>
    <Phase>Any</Phase>
    <Technology>Scala with Play Framework</Technology>
    <Type>Vulnerability</Type>
    <DirectLink>Insecure Cryptographic Storage</DirectLink>
    <Author />
    <Priority />
    <Status />
  </Metadata>
  <Content Sanitized="false" DataType="html">
    <Data><![CDATA[<br />
  <h1 style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 15px; margin: 0px; padding: 0px; color: rgb(17, 17, 17);">Description</h1>
  <p style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; line-height: 1.5em; margin: 0.5em 0px 1em; padding: 0px; color: rgb(17, 17, 17);">Insecure cryptographic storage is a collection of vulnerabilities that relate to the need to properly encrypt stored data.&amp;nbsp; The vulnerability is caused by failure to: <br /></p>
  <ul>
    <li>
      <span style="line-height: 1.5em;">Encrypt the correct data.</span>
    </li>
    <li>
      <span style="line-height: 1.5em;">Use proper key storage and management techniques.</span>
    </li>
    <li>
      <span style="line-height: 1.5em;">Use proven, secure algorithms and cryptography techniques (rather than homegrown algorithms and cryptography, which are less likely to be secure).</span>
    </li>
    <li>
      <span style="line-height: 1.5em;">Anticipate that an internal user of the application may gain access to the registry, temporary files, and databases, and may access </span>
      <span style="line-height: 1.5em;">
        <span style="line-height: 1.5em;">unencrypted</span> data using temporary, hidden, and registry files.</span>
    </li>
  </ul>
  <p style="font-size: 15px; margin: 0px; padding: 0px; color: rgb(17, 17, 17);">
    <font face="Arial" size="2">Note: The ability of external attackers&amp;nbsp;to exploit insecure cryptographic storage
 vulnerabilities is limited by the difficulty of gaining access to the 
internal network. They would need to compromise a 
machine on the internal network in order to access unencrypted stored 
information.<br /></font>
  </p>
  <ul>
  </ul>
  <p />
  <h2 style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 15px; margin: 0px; padding: 0px; color: rgb(17, 17, 17);">Impact</h2>
  <ul>
  </ul>All unencrypted stored data can potentially be compromised. This may include sensitive, confidential information of any nature.<br /><ul></ul><h2 style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 15px; margin: 0px; padding: 0px; color: rgb(17, 17, 17);">Countermeasures</h2><div><ol><li>Make use of a public, well-known algorithm whose strength has been tested and proven by experts in the field. AES and 3-DES are examples of strong symmetric algorithms. RSA and NTRU are examples of strong asymmetric algorithms.</li><li>Avoid using homegrown cryptographic algorithms. Though the algorithms might appear strong, it is likely that skilled cryptographers can defeat them through a variety of reverse engineering techniques.</li><li>Find libraries that implement your chosen cryptographic algorithms. In some cases, they may be implemented by the platform. Find out the APIs for using these algorithms.</li><li>Add functions that use your chosen cryptographic APIs to encrypt and decrypt the various types of sensitive data that your application handles.</li><li>Find the code in your application that handles sensitive data. To this, add code that calls your new encryption functions to encrypt and decrypt sensitive data, as appropriate.&amp;nbsp;</li></ol></div><div>Refer to the following Guidelines to help implement secure cryptographic storage:<br /></div><div><ul style="margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; background-color: rgb(255, 255, 255);"><li style="margin: 0px; padding: 0px;"><font color="#3366ff"><a href="11b8870d-ba93-4916-a889-cf55f5562b02">Consider the Threats to Data</a><br /><span style="margin: 0px; padding: 0px;"><a href="3ebe4394-e2f3-4f73-9c9a-b3206997836b" target="_blank" style="margin: 0px; padding: 0px;"><span class="typ" style="margin: 0px; padding: 0px;"></span></a></span></font></li><li style="margin: 0px; padding: 0px;"><font color="#3366ff"><span style="margin: 0px; padding: 0px;"><a href="3ebe4394-e2f3-4f73-9c9a-b3206997836b" target="_blank" style="margin: 0px; padding: 0px;"><span class="typ" style="margin: 0px; padding: 0px;">Hash </span><span class="pln" style="margin: 0px; padding: 0px;"></span><span class="kwd" style="margin: 0px; padding: 0px;">and </span><span class="pln" style="margin: 0px; padding: 0px;"></span><span class="typ" style="margin: 0px; padding: 0px;">Salt</span><span class="pln" style="margin: 0px; padding: 0px;"></span><span class="typ" style="margin: 0px; padding: 0px;"> Passwords</span><span class="pln" style="margin: 0px; padding: 0px;"></span><span class="kwd" style="margin: 0px; padding: 0px;"> for</span><span class="pln" style="margin: 0px; padding: 0px;"></span><span class="typ" style="margin: 0px; padding: 0px;"> Storage</span></a></span></font></li><li style="margin: 0px; padding: 0px;"><font color="#3366ff"><span style="margin: 0px; padding: 0px;"><a href="1d36a6e8-fcbb-4205-8d3a-b2366e2f9f78" target="_blank" style="margin: 0px; padding: 0px;"><span class="typ" style="margin: 0px; padding: 0px;">Use</span><span class="pln" style="margin: 0px; padding: 0px;"></span><span class="typ" style="margin: 0px; padding: 0px;"> Strong</span><span class="pln" style="margin: 0px; padding: 0px;"></span><span class="typ" style="margin: 0px; padding: 0px;"> Symmetric </span><span class="pln" style="margin: 0px; padding: 0px;"></span><span class="typ" style="margin: 0px; padding: 0px;">Encryption</span></a></span></font></li><li style="margin: 0px; padding: 0px;"><font color="#3366ff"><span style="margin: 0px; padding: 0px;"><a href="7e5f0d99-7f46-4c7f-a3cd-10e3d9f904bb" target="_blank" style="margin: 0px; padding: 0px;"><span class="typ" style="margin: 0px; padding: 0px;">Use</span><span class="pln" style="margin: 0px; padding: 0px;"></span><span class="typ" style="margin: 0px; padding: 0px;"> Strong </span><span class="pln" style="margin: 0px; padding: 0px;"></span><span class="typ" style="margin: 0px; padding: 0px;">Asymmetric </span><span class="pln" style="margin: 0px; padding: 0px;"></span><span class="typ" style="margin: 0px; padding: 0px;">Encryption</span></a></span></font></li><li style="margin: 0px; padding: 0px;"><font color="#3366ff"><span style="margin: 0px; padding: 0px;"><a href="85b85b5f-4aec-452e-9474-2c420922baa8" target="_blank" style="margin: 0px; padding: 0px;"><span class="typ" style="margin: 0px; padding: 0px;">Encrypt </span><span class="pln" style="margin: 0px; padding: 0px;"></span><span class="typ" style="margin: 0px; padding: 0px;">Off</span><span class="pun" style="margin: 0px; padding: 0px;">-</span><span class="pln" style="margin: 0px; padding: 0px;">site</span><span class="typ" style="margin: 0px; padding: 0px;"> Backups</span></a></span></font></li></ul></div><p style="font-family: Arial, Verdana; font-size: 10pt;" /><h2 style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 15px; margin: 0px; padding: 0px; color: rgb(17, 17, 17);"><font color="#000000"></font><br /></h2><h2 style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 15px; margin: 0px; padding: 0px; color: rgb(17, 17, 17);">Application Check</h2><p style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; margin: 0.5em 0px 1em; padding: 0px; line-height: 1.5em; color: rgb(17, 17, 17);">To check for adequate protection against this vulnerability, refer to the following Checklist Items:<span class="Apple-tab-span" style="white-space: pre;"></span></p><ul style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; color: rgb(17, 17, 17);"><li style="margin: 0px; padding: 0px;"><b style="margin: 0px; padding: 0px;"></b><font color="#3333ff"><span style="margin: 0px; padding: 0px;"><a href="8acdd7d4-a3ac-489b-9de7-95e76f9aac41" target="_blank" style="margin: 0px; padding: 0px;">Threats to Data Are Considered</a></span></font></li><font color="#3333ff"></font><li style="margin: 0px; padding: 0px;"><font color="#3333ff"><span style="margin: 0px; padding: 0px;"><a href="ab9a7b0e-47d7-4746-b5dc-a8a9c0181fee" target="_blank" style="margin: 0px; padding: 0px;">Passwords Are Hashed and Salted for Storage</a></span></font></li><li style="margin: 0px; padding: 0px;"><font color="#3333ff"><span style="margin: 0px; padding: 0px;"><a href="fc8f700d-be5f-492d-9dc1-560bcdbe7c5d" target="_blank" style="margin: 0px; padding: 0px;">Strong Symmetric Encryption Is Used</a></span></font></li><font color="#3333ff"></font><li style="margin: 0px; padding: 0px;"><font color="#3333ff"><span style="margin: 0px; padding: 0px;"><a href="d3d5c2de-fd8a-4e85-8157-bdd39d1c8b07" target="_blank" style="margin: 0px; padding: 0px;">Strong Asymmetric Encryption Is Used</a></span></font></li><font color="#3333ff"></font><li style="margin: 0px; padding: 0px;"><font color="#3333ff"><span style="margin: 0px; padding: 0px;"><a href="4356770d-fff8-41eb-ae3f-32318bc05da1" target="_blank" style="margin: 0px; padding: 0px;">Off-site Backups Are Encrypted</a></span></font><b style="margin: 0px; padding: 0px;"></b></li></ul><div><font color="#111111" face="Segoe UI, Helvetica Neue, Helvetica, Arial, sans-serif" size="2"><br /></font></div><h2 style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 15px; margin: 0px; padding: 0px; color: rgb(17, 17, 17);">Web-Based Training</h2><p style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; line-height: 1.5em; margin: 0.5em 0px 1em; padding: 0px; color: rgb(17, 17, 17);"><a href="https://vulnerabilities.teammentor.net/article/279ad567-2b34-44ce-8e56-8d96770ba500" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0); font-weight: bold;">AWA 101 Fundamentals of Application Security</a></p><p style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; line-height: 1.5em; margin: 0.5em 0px 1em; padding: 0px; color: rgb(17, 17, 17);">This two-part course is ideal for security and development practitioners that want to understand software security risk and seek specific implementation guidance on how to build and deploy more secure software applications. It starts off describing why software security is critical and the risk that software vulnerabilities represent, and proceeds to lay the foundation for secure software development by presenting specific security controls and principles that development teams can implement immediately to reduce software risk.</p><p style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; line-height: 1.5em; margin: 0.5em 0px 1em; padding: 0px; color: rgb(17, 17, 17);"><br /></p><h2 style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 15px; margin: 0px; padding: 0px; color: rgb(17, 17, 17);">Additional Resources</h2><ul style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; color: rgb(17, 17, 17);"><li style="margin: 0px; padding: 0px;">For more information about Insecure Cryptographic Storage vulnerabilities, please see&amp;nbsp;<a href="https://www.owasp.org/index.php/Top_10_2010-A7-Insecure_Cryptographic_Storage">https://www.owasp.org/index.php/Top_10_2010-A7-Insecure_Cryptographic_Storage</a></li><li style="margin: 0px; padding: 0px;">CEW for Broken or Risky Cryptography can be seen here:&amp;nbsp;<a href="http://cwe.mitre.org/data/definitions/327.html">http://cwe.mitre.org/data/definitions/327.html</a></li></ul><p><br /></p><p><br /></p>]]></Data>
  </Content>
</TeamMentor_Article>