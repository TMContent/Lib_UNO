<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="0" Content_Hash="0">
  <Metadata>
    <Id>fc02dc5c-f020-484f-842d-b119791d8d53</Id>
    <Id_History>81df542f-e8b5-47b4-90ac-15892276ed50,</Id_History>
    <Library_Id>d9c2b53f-5b05-4152-be72-e79d72854707</Library_Id>
    <Title>Failure to Restrict URL Access</Title>
    <Category>OWASP</Category>
    <Phase>Any</Phase>
    <Technology>Scala with Play Framework</Technology>
    <Type>Vulnerability</Type>
    <DirectLink>Failure to Restrict URL Access</DirectLink>
    <Author />
    <Priority />
    <Status />
  </Metadata>
  <Content Sanitized="false" DataType="html">
    <Data><![CDATA[<h2>Description</h2>
  <p>Applications normally manage access to resources/URLs via the configuration files. Often, URLs that are meant to be viewed only by authorized users are hidden from the user interface and, if the configuration is not proper, the application won't perform access control validation every time the URL is accessed. This failure to restrict URL access allows an attacker to brute-force the URL in order to gain access to hidden pages and sensitive content. Attacks that can be used to gain URL access are:</p>
  <p>
  </p>
  <ul>
    <li>Path manipulation</li>
    <li>Directory traversal</li>
    <li>Forced browsing</li>
  </ul>
  <p />
  <h2>Impact</h2>
  <p>When the application fails to properly restrict URL access, an attacker can gain direct access, view, and download sensitive resources -- including source files -- that are on the web server. <br /></p>
  <h2>Countermeasures</h2>
  <p>For each resource/URL, consider the following questions before providing access:</p>
  <p>
  </p>
  <ul>
    <li>Should the page be accessible without authentication?</li>
    <li>Is the current user authorized to access this page?</li>
  </ul>
  <div>To prevent unauthorized URL access;<br /><ul><li>Validate the user's session on every page. <br /></li><li>Ensure that the user is authorized to access a page before granting him access. <br /></li><li>Re-authenticate the user before granting access to a sensitive page such as a transaction page. <br /></li></ul>Regardless of the mechanism(s), all of the following are recommended:</div>
  <p />
  <p />
  <ul>
    <li>Ensure that authentication and authorization policies are role based, to minimize the effort required to maintain these policies.</li>
    <li>Ensure that policies are highly configurable. Minimize any hard-coded aspects of the policy.</li>
    <li>Ensure that enforcement mechanisms deny all access by default. Require explicit grants to specific users and roles for access to every page.</li>
    <li>If the page is involved in a workflow, check to make sure the conditions are in the proper state to allow access.&amp;nbsp;</li>
  </ul>
  <p />
  <p>In Play Framework 2.1.0+, you can use <a href="https://github.com/schaloner/deadbolt-2">DeadBolt-2</a> as an authorization system that defines the access rights to certain controller methods or parts of a view. You can use <a href="https://github.com/jaliss/securesocial">SecureSocial</a> as the framework for verifying the authorization of the logged-in user to access the restricted section/URL of the website.&amp;nbsp;</p>
  <p>Verify that the user is authorized to access the page before granting him access to a critical resource&amp;nbsp;such as a configuration file. Generate an error, or even exit the software, if there is a possibility that the resource could have been modified by an unauthorized party. To implement this, make use of an Access Control Library such as&amp;nbsp;<a href="https://www.owasp.org/index.php/ESAPI_Access_Control">OWASP ESAPI Access Control</a>.&amp;nbsp;</p>
  <p>Refer to the following Guidelines to help implement a secure deployment:</p>
  <ul style="margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; background-color: rgb(255, 255, 255);">
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="8e5263d3-3fc8-43a9-9636-57094c58f4c4" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Remove Test Accounts</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="5a36d20f-d8e0-4a86-8776-1f3e95a9da9c" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Disable Directory Browsing</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="15ccde50-5626-4d85-872d-7ea4ee50e749" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Do Not Store Plain Text Data</a>
      </b>
    </li>
  </ul>
  <div>
    <font face="Segoe UI, Helvetica Neue, Helvetica, Arial, sans-serif" size="2">Refer to the following Guidelines to help implement proper authorization mechanisms:</font>
  </div>
  <div>
    <ul style="margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; background-color: rgb(255, 255, 255);">
      <li style="margin: 0px; padding: 0px;">
        <b style="margin: 0px; padding: 0px;">
          <a href="b7176093-9004-4b9f-8b6b-4a56c6e9cb87" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Require Authentication and Authorization for All Sensitive Pages</a>
        </b>
      </li>
      <li style="margin: 0px; padding: 0px;">
        <b style="margin: 0px; padding: 0px;">
          <a href="08b369bf-b2ff-47e1-92c7-11c8607fbe00" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Make Authentication and Authorization Policies Configurable</a>
        </b>
      </li>
      <li style="margin: 0px; padding: 0px;">
        <b style="margin: 0px; padding: 0px;">
          <a href="10a459c4-4a39-4325-b3a9-a3458ac43b0c" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Deny All Access by Default</a>
        </b>
      </li>
      <li style="margin: 0px; padding: 0px;">
        <b style="margin: 0px; padding: 0px;">
          <a href="be7b255c-ce4b-427b-8b02-66e78481179e" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Check Access Control Permissions When Referencing Objects</a>
        </b>
      </li>
      <li style="margin: 0px; padding: 0px;">
        <b style="margin: 0px; padding: 0px;">
          <a href="0cdb8ff4-a9f0-47d8-b32c-b72e2da858d9" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Use Indirect Object References</a>
        </b>
      </li>
      <li style="margin: 0px; padding: 0px;">
        <b style="margin: 0px; padding: 0px;">
          <a href="42892132-de71-41b9-8c35-8f8ee23cb758" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Partition the Application Between Public and Private Domains</a>
        </b>
      </li>
      <li style="margin: 0px; padding: 0px;">
        <b style="margin: 0px; padding: 0px;">
          <a href="52ea4336-7d99-47b3-bea2-2ac33da6e1a2" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Secure the Account Administration Functionality</a>
        </b>
      </li>
      <li style="margin: 0px; padding: 0px;">
        <b style="margin: 0px; padding: 0px;">
          <a href="4a62104f-8abf-4d1f-8959-04b59b6db3b4" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Automatically Lock Inactive User Accounts</a>
        </b>
      </li>
    </ul>
  </div>
  <h2>Application Check<br /></h2>
  <div>
    <p style="font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; margin: 0.5em 0px 1em; padding: 0px; line-height: 1.5em; color: rgb(17, 17, 17);">To check for adequate protection against this vulnerability, refer to the following Checklist Items:<span class="Apple-tab-span" style="white-space: pre;"></span></p>
  </div>
  <ul style="margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; background-color: rgb(255, 255, 255);">
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="ebe0ff95-10a5-4243-a77c-7e07a7381470" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Test Accounts Are Removed</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="9e6c8b45-6078-466a-9390-3aacc7fc8ff5" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Directory Browsing Is Disabled</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="15ccde50-5626-4d85-872d-7ea4ee50e749" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Sensitive Data Inside Configuration Files Is Protected</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="001453f0-a647-4307-ad94-4077307f71a1" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Authentication and Authorization Are Required for All Sensitive Pages</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="a1310a50-1c9f-49f1-ad3e-ae1002e51b00" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Authentication and Authorization Policies Are Configurable</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="e118152a-8a32-455d-b8ee-4b5d4c66742e" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">All Access Is Denied by Default</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="b01e90c6-bf52-4db8-b2ce-2b5a89a40815" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Access Control Permissions Are Checked When Referencing Objects</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="42ff8254-15b9-4e5c-af6e-0ea617354b4f" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Indirect Object References Are Used</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="41a04d3f-0bb5-4904-bb28-134a109f9ce0" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">The Application Is Partitioned into Public and Private Domains</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="02b0be6c-99ed-4ff6-8805-8fc0a7402ae5" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Account Administration Functionality Is Secured</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="1a839a80-f801-4bcd-895b-a62cddac93bc" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Inactive User Accounts Are Automatically Locked</a>
      </b>
    </li>
  </ul>
  <h2>Web-Based Training</h2>
  <p>
    <a href="https://vulnerabilities.teammentor.net/article/279ad567-2b34-44ce-8e56-8d96770ba500" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0); font-weight: bold;">AWA 101 Fundamentals of Application Security</a>
  </p>
  <p>This two-part course is ideal for security and development practitioners that want to understand software security risk and seek specific implementation guidance on how to build and deploy more secure software applications. It starts off describing why software security is critical and the risk that software vulnerabilities represent, and proceeds to lay the foundation for secure software development by presenting specific security controls and principles that development teams can implement immediately to reduce software risk.</p>
  <h2>Additional Resources</h2>
  <ul style="margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; color: rgb(17, 17, 17); font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small;">
    <li style="margin: 0px; padding: 0px;">For more information about Failure to Restrict URL access, please see&amp;nbsp;<a href="http://www.jtmelton.com/2010/08/17/the-owasp-top-ten-and-esapi-part-11-failure-to-restrict-url-access/">http://www.jtmelton.com/2010/08/17/the-owasp-top-ten-and-esapi-part-11-failure-to-restrict-url-access/</a></li>
  </ul>
  <p>
    <br />
  </p>
  <p>
    <br />
  </p>
  <ul style="margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; color: rgb(17, 17, 17); font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small;">
  </ul>]]></Data>
  </Content>
</TeamMentor_Article>