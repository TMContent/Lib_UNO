<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="0" Content_Hash="0">
  <Metadata>
    <Id>859775fd-7b1a-4f93-9e12-854b0613cfb0</Id>
    <Library_Id>be5273b1-d682-4361-99d9-6234f2d47eb7</Library_Id>
    <Title>[1612Dupe] Cryptographic Keys Are Protected</Title>
    <Category>Cryptography</Category>
    <Phase>Deployment</Phase>
    <Technology>AWS</Technology>
    <Type>Checklist Item</Type>
    <DirectLink />
    <Tag />
    <Author />
    <Priority />
    <Status />
  </Metadata>
  <Content Sanitized="false" DataType="markdown">
    <Data><![CDATA[## What to Check For ##

Verify that cryptographic keys are protected.

## Why ##

Keys should remain in the key vault at all times. If the cryptographic keys are unavailable, any compromised data is unusable by a thief. 


## When ##

Any crypto key used must be protected from unauthorized access. Define a key lifecycle so that it is rekeyed, and then removed from use on a prescribed schedule. The lifecycle you define for security of crypto keys will tell you when to remove the key from use.

When your application uses multiple keys, their makeup must be independent, and not related. All keys must be stored away from the data, so that a compromise will not result in the theft of the key and data.


## How to Check ##

To verify that cryptographic keys are protected:

1. **Find encryption and decryption code.** Find the code that is responsible for performing encryption and decryption in your application.

2. **Identify cryptographic storage.** Examine the cryptographic code to determine where the cryptographic keys are stored.

3. **Examine cryptographic storage.** Verify that cryptographic keys are protected when they are stored. HSM is an acceptable solution. If some other secure storage mechanism is used, verify that it is up to your organization's standards. Storing cryptographic keys in plain-text is not acceptable.


## How to Fix ##

AWS encourages the use of a hardware security module (HSM). Such an appliance provides secure key storage and cryptographic operations in the cloud. This is an overview of steps you will take to get started with the HSM. 

1. **Set up the HSM environment.** Setup your account in the administrators group and generate your access key. Create an IAM policy to use CloudHSM and attach it to users. Setup private and public subnets, IAM role, EC2 instance, and security group in your VPC environment. Now generate SSH key pair and setup the CLI tools.

2. **Provision the HSM.** Use the CLI to create an HSM from your control instance with the `create-hsm` command. You will need to supply `subnet_id`, `public_key_file`, `iam_role_arn`, and `syslog_ip_address` from the previous step.

3. **Configure the HSM.** With the CLI, use `list-hsms` and `describe-hsm` to get the HSM ENI Identifier and IP Address. Apply the security group through the EC2 console. In the CLI use `initialize-hsm` and required parameters.

4. **Connect the HSM.** Connect the on-premises HSM appliances to your HSM VPC.

5. **Configure the HSM client.** Download and install a Linux or Windows client with required options for the appliance.

6. **Configure HA.** 

7. **Integrate CloudHSM with the application.**


]]></Data>
  </Content>
</TeamMentor_Article>