<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="0" Content_Hash="0">
  <Metadata>
    <Id>33fb64e2-51e1-499e-adde-8ac5bae15b26</Id>
    <Id_History>33fb64e2-51e1-499e-adde-8ac5bae15b26,ac9fca7e-b8d8-4c9a-a828-0658a2413a26,</Id_History>
    <Library_Id>d9c2b53f-5b05-4152-be72-e79d72854707</Library_Id>
    <Title>Usernames Are Validated Before Use</Title>
    <Category>Authentication</Category>
    <Phase>Implementation</Phase>
    <Technology>Scala with Play Framework</Technology>
    <Type>Checklist Item</Type>
    <DirectLink>Usernames Are Validated Before Use</DirectLink>
    <Author />
    <Priority />
    <Status />
  </Metadata>
  <Content Sanitized="false" DataType="html">
    <Data><![CDATA[<h1>Applies to</h1>
  <p>Scala and Play Framework 2.1.0+<br /></p>
  <h1>What to Check For</h1>
  <p>Ensure user credentials are validated before processing them.</p>
  <h1>Why</h1>
  <p>Failure to validate user credentials could cause improper authentication. This can allow an attacker to authenticate as another user without the need to steal credentials.</p>
  <h1>How to Check</h1>
  <p>Follow these steps to ensure that your application validates user credentials before use:</p>
  <ol>
    <li>
      <p>
        <strong>Locate all code that handles user credentials.&amp;nbsp;</strong>Examine your application and identify all places inside its code base that handle user credentials. Common places include:</p>
      <ul>
        <li>Creating new users</li>
        <li>Modifying existing users</li>
        <li>Changing credentials for existing users</li>
        <li>Retrieving information related to existing users</li>
        <li>Removing existing users</li>
        <li>Authenticating users</li>
      </ul>
    </li>
    <li>
      <p>
        <strong>Verify that validation is handled properly.&amp;nbsp;</strong>Ensure that your application addresses username validation throughout the different stages of your application's development lifecycle:</p>
      <ul>
        <li>
          <p>
            <strong>Policy Requirements</strong>:&amp;nbsp;Verify that&amp;nbsp;your application's security requirements have established a policy regarding acceptable usernames. Such policy should state the length and input set for valid usernames as well as password requirements. Consult the&amp;nbsp;<a href="2643951d-7530-4c34-a4a9-3111095dedb6">Strong Passwords are Enforced</a>&amp;nbsp;checklist for additional information regarding password requirements.</p>
        </li>
        <li>
          <p>
            <strong>Design</strong>:&amp;nbsp;Verify that&amp;nbsp;all username validation routines are positioned properly at the trust boundaries of all of your application's routines that handle user credentials. For instance, all validation should occur before the username is processed by any component within your application.</p>
        </li>
        <li>
          <p>
            <strong>Implementation:</strong>&amp;nbsp;Verify that&amp;nbsp;all username validation routines implement your application's username&amp;nbsp;policy. Verify that the implementation is using whitelist and not blacklist validation techniques. Example:</p>
          <pre>val pid = UserForm.empid
val uname = UserForm.username
val name = Name.findname(pid, uname)
val whitelistPattern = "(\\w|\\d)+".r
val issafe =whitelistPattern.pattern.matcher(uname).matches
if (issafe){
...... //Code for Action
}else{
...... //Code for Exception
}
</pre>
          <div>Ensure that all error or exception conditions are handled correctly. Verify that all authentication procedures exit immediately in a graceful manner upon failed username validation. Consult the&amp;nbsp;<a href="fb6e2a2e-7d42-46e6-99bd-a728c1e95453">Valuable Information is Not Disclosed During Authentication Errors</a> checklist for more details.</div>
        </li>
      </ul>
    </li>
  </ol>
  <h1>How to Fix</h1>
  <p>Use the following steps when validating user credentials:</p>
  <ol>
    <li>
      <p>
        <strong>Establish username requirements.&amp;nbsp;</strong>Determine what is the acceptable character set and length that should be allowed within a username. For instance, require that usernames should be at least&amp;nbsp;six characters long and must contain alpha-numeric characters only.</p>
    </li>
    <li>
      <p>
        <strong>Use whitelist validation.&amp;nbsp;</strong>Whitelisting involves the establishment of what is good input for your application. Once good input is defined, compare all input against the established good input. If the input does not resemble good input, your application should discard it. This technique can be implemented using regular expressions. Example:</p>
      <pre>val pid = UserForm.empid
val uname = UserForm.username
val name = Name.findname(pid, uname)
val whitelistPattern = "(\\w|\\d)+".r
val issafe =whitelistPattern.pattern.matcher(uname).matches
if (issafe){
...... //Code for Action
}else{
...... //Code for Exception
}
</pre>
      <div>
        <br />
      </div>
    </li>
  </ol>
  <h1>
  </h1>
  <h1 style="margin: 0px; padding: 10px 0px 0px; font-size: 17px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255);">Additional Resources</h1>
  <ul style="margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; font-weight: normal; background-color: rgb(255, 255, 255);">
    <li style="margin: 0px; padding: 0px;">A tutorial on regular expressions is available at&amp;nbsp;<a href="http://www.regular-expressions.info/" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0); font-weight: bold;">Regular-Expressions.info</a>.</li>
    <li style="margin: 0px; padding: 0px;">For more information on using regular expression in Scala, see: Documentation for&amp;nbsp;<a href="http://www.scala-lang.org/api/current/index.html#scala.util.matching.Regex" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0); font-weight: bold;">Regex Pattern</a>&amp;nbsp;in Scala documentation.</li>
  </ul>]]></Data>
  </Content>
</TeamMentor_Article>