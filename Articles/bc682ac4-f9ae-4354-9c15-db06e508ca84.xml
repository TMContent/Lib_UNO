<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="0" Content_Hash="0">
  <Metadata>
    <Id>bc682ac4-f9ae-4354-9c15-db06e508ca84</Id>
    <Id_History>bc682ac4-f9ae-4354-9c15-db06e508ca84,c9485a97-49ae-44d6-81d5-8603a0a0df3b,</Id_History>
    <Library_Id>c037d0d2-0617-44f3-b846-21dc3d02c4f8</Library_Id>
    <Title>External Commands Are Avoided</Title>
    <Category>Dangerous APIs</Category>
    <Phase>Implementation</Phase>
    <Technology>PHP</Technology>
    <Type>Checklist Item</Type>
    <DirectLink>External Commands Are Avoided</DirectLink>
    <Author />
    <Priority />
    <Status />
  </Metadata>
  <Content Sanitized="false" DataType="wikitext">
    <Data><![CDATA[==Applies To==

* PHP

==What to Check For==

Verify that external OS commands are used as little as possible.


==Why==

Using external commands for application functionality creates the potential for command injection vulnerabilities. If it's possible to satisfy design requirements using PHP code, do that instead of using external commands.

==How to Check==

To verify that external OS commands are used as little as possible:

# **Find all code that uses external commands.** To identify potential trouble spots, find all the code in the application that executes operating system commands by searching for use of the following functions: exec, passthru, shell_exec, system, proc_open, popen, curl_exec, curl_multi_exec, pcntl_exec, dl. Make a spreadsheet of all this code.
# **Determine whether external commands are necessary.** External commands are often used to process or communicate data, either for performance reasons or to simplify implementation. For each external command, determine if it is possible to replace it with application code that does the same thing without relying on other programs. Even if it is not practical to replace an external command with application code, consider removing the code that executes external commands altogether, which of course removes the associated functionality, but also removes potentially vulnerable code; that is the trade-off that needs to be considered.

==How to Fix==

To remove code that uses external commands:

# **Find all code that uses external commands.** To identify potential trouble spots, find all the code in the application that executes operating system commands by searching for use of the following functions: exec, passthru, shell_exec, system, proc_open, popen, curl_exec, curl_multi_exec, pcntl_exec, dl. Make a spreadsheet of all this code.
# **Replace code that uses external commands.** Using the spreadsheet as a guide, examine each piece of code that executes operating system commands and determine whether it is absolutely necessary to the application. If possible, rewrite that code to use only PHP functions, thus removing the possibility that it contains a command injection vulnerability.
]]></Data>
  </Content>
</TeamMentor_Article>