<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="0" Content_Hash="0">
  <Metadata>
    <Id>dd606077-5850-4dff-8db8-f0e2fa58e5f8</Id>
    <Id_History>5d296e90-a27c-424a-bfe1-5576490b50c2,</Id_History>
    <Library_Id>d9c2b53f-5b05-4152-be72-e79d72854707</Library_Id>
    <Title>Protect Session Cookies</Title>
    <Category>Session Management</Category>
    <Phase>Implementation</Phase>
    <Technology>Scala with Play Framework</Technology>
    <Type>Guideline</Type>
    <DirectLink>Protect Session Cookies</DirectLink>
    <Author />
    <Priority />
    <Status />
  </Metadata>
  <Content Sanitized="false" DataType="html">
    <Data><![CDATA[<h1>Applies To</h1>
  <p>Scala and Play Framework 2.1.0+<br /></p>
  <h1>What to Do</h1>
  <p>Protect the confidentiality of session cookies.</p>
  <h1>Why</h1>
  <p>Session cookies are used by an application to identify the session associated with a particular user. Protecting session cookies can help prevent an attacker from hijacking the session and using the application as a legitimate user.</p>
  <h1>When</h1>
  <p>If your application uses cookies to maintain a user's session state, then use this guideline to protect the cookie.</p>
  <h1>How</h1>
  <p>To secure session cookies:</p>
  <ol>
    <li>
      <p>
        <strong>Do not allow users to choose their own session identifiers.&amp;nbsp;</strong>Use the Scala cookie feature to automatically assign random IDs to its sessions. This minimizes the risk of an attacker hijacking another user's session by using the same session ID. To use sessions in Scala, invoke <i>play.api.mvc.Cookie.</i></p>
    </li>
    <li>
      <p>
        <strong>Invalidate the session identifier on login (as well as logout) to ensure session identifiers are not reused.</strong>&amp;nbsp;This is necessary to prevent session hijacking. After the session has been invalidated, make a call to generate a new session identifier.</p>
    </li>
    <li>
      <p />
      <strong>Time-out sessions.&amp;nbsp;</strong>Set an expiration time for sessions. This helps minimize the threat of session hijacking by giving an attacker a smaller window of opportunity. Depending on your application, an appropriate timeout can be anywhere from 10 to 20 minutes.<p /></li>
    <li>
      <p>
        <strong>Allow users to terminate their sessions.&amp;nbsp;</strong>Allowing users to invalidate their sessions reduces the risk of the session being hijacked. Use&amp;nbsp;<i>result.discardingCookies</i>&amp;nbsp;to accomplish this.</p>
    </li>
    <li>
      <p />
      <strong>Ensure cookies are sent over encrypted channels.&amp;nbsp;</strong>Mark cookies sent over SSL as&amp;nbsp;<em>Secure</em>. Use the&amp;nbsp; <em><span style="font-style: normal;">Enable Secure flag on the cookie, setting “application.session.secure=true” in the “application.conf” file</span></em>. Do not send session cookies over unencrypted channels as session hijacking is made much easier.<br /></li>
  </ol>
  <p>
    <strong>Note:</strong>&amp;nbsp;PCI DSS requirements state that sessions that are idle for 15 minutes should be locked automatically and require the user's password to unlock.</p>
  <h1 style="margin: 0px; padding: 10px 0px 0px; font-size: 17px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255);">Session Management Guidelines</h1>
  <ul style="margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; background-color: rgb(255, 255, 255);">
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="13ad7fa3-199e-4957-9e4f-39bd931c9f1d" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Protect Session IDs</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="5d296e90-a27c-424a-bfe1-5576490b50c2" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Protect Session Cookies</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="f4218f89-d394-4162-8108-faef064f0f65" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Set the Domain and Path Values of Session Cookies</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="0c4222a4-6028-4191-8dcb-761bbb4d2661" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Set the Secure and HTTPOnly Flags on All Sensitive Cookies</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="b8e65bce-05bb-40b0-bc5b-ea6fe1e3ce96" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Change Session IDs During Authentication</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="05a2cfa6-d015-446b-8c25-3cb13f10d396" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Invalidate Sessions when Users Log Out</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="6ac43864-2644-4f33-bfb2-1366c5c3cb58" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Make Inactive Sessions Time-out</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="19f2779c-14ec-43fb-8e8d-4505cb0801c9" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Include Unique Tokens in HTTP Requests</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="7889a5ad-4e61-41da-97da-d40337050e17" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Do Not Make Security Decisions Based on Client-Accessible Parameters</a>
      </b>
    </li>
  </ul>
  <h1 style="margin: 0px; padding: 10px 0px 0px; font-size: 17px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255);">Session Management Checklists</h1>
  <ul style="margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; background-color: rgb(255, 255, 255);">
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="9dfbcbed-d897-4df4-b212-9d80fb26cbdf" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Session IDs Are Protected</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="fe0a7400-2140-4e9e-bcc7-f185acce6974" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Session Cookies are Protected</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="932cd357-dfd4-4f95-949b-e407b5299748" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">The Domain and Path Values of Session Cookies Are Strict</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="0679ade9-860f-42e0-b811-2a3434410a76" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">The Secure and HTTPOnly Flags Are Set on All Sensitive Cookies</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="3328e0df-abe9-4339-9eeb-fae6eb54042e" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Session IDs Are Changed During Authentication</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="636b0c98-34d0-4aed-bf06-35f80a6e5551" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Sessions Are Invalidated When Users Log Out</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="22c6bd72-94a7-4b86-9c9b-60d921fbd266" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Inactive Sessions Time-out</a>
      </b>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <b style="margin: 0px; padding: 0px;">
        <a href="178b26f6-689b-4a0e-a117-eadf1af3404c" target="_blank" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0);">Unique Tokens Are Included in HTTP Requests</a>
      </b>
    </li>
  </ul>]]></Data>
  </Content>
</TeamMentor_Article>