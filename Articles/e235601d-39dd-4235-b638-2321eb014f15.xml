<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="0" Content_Hash="0">
  <Metadata>
    <Id>e235601d-39dd-4235-b638-2321eb014f15</Id>
    <Id_History>e235601d-39dd-4235-b638-2321eb014f15,d88b8fb7-b77b-4940-b4fc-b54e5bb4c039,</Id_History>
    <Library_Id>be5273b1-d682-4361-99d9-6234f2d47eb7</Library_Id>
    <Title>Platform Banners Are Disabled</Title>
    <Category>Hardening</Category>
    <Phase>Implementation</Phase>
    <Technology>PHP</Technology>
    <Type>Checklist Item</Type>
    <DirectLink>Platform Banners Are Disabled</DirectLink>
    <Author />
    <Priority />
    <Status />
  </Metadata>
  <Content Sanitized="false" DataType="wikitext">
    <Data><![CDATA[==Applies To==

* PHP

==What to Check For==

Check that your application server discloses as little as possible about the presence of PHP.

==Why==

Hiding PHP will make it just a little bit harder for attackers to figure out how to look for holes in the application. It makes just a small difference, but some recommend it anyway. With PHP in particular, for any reasonably sized application, it is quite difficult to fully hide that PHP is being used. Still, it is relatively easy to take some simple steps towards doing so.

==How to Check==

To verify that measures are taken to conceal PHP:

# **Check the expose_php setting.** Verify that the expose_php directive in php.ini is set to "off".
# **Check the display_errors setting.** Verify that the display_errors directive in php.ini is set to "off".
# **Check the ServerTokens setting.** Verify that the ServerTokens directive in php.ini is set to "Prod".
# **Check the ServerSignature setting.** Verify that the ServerSignature directive in php.ini is set to "off".
# **Check assigned php file extensions.** Verify that a custom and unique file extension is assigned to PHP files and that your application files use that file extension.
# **Check the names of session cookies.** Verify that the session.name directive in php.ini is set to a custom name that does not indicate that PHP is being used.


==How to Fix==

To help hide the fact that your application uses PHP: 

Add the following directives to the php.ini file:

{{{
expose_php = off
display_errors = off
ServerTokens Prod
ServerSignature = off 
}}}

The .php file extension of the application files will still be a dead give-away. To prevent this, change extensions of application files to something else, for example ".app" and, if you are using Apache, add the following directive to the Apache configuration file (for other web server types the procedure would be different):

{{{
AddType application/x-httpd-php .app
}}}

You can also use ModRewrite for Apache to rewrite request URLs to hide the .php file extensions, but this is limited to applications running on Apache web servers.

If your application uses PHP sessions, change the name of the session cookie by using the session.name php.ini directive:

{{{
session.name = "SESSIONID"
}}}

==Additional Resources==

* For a discussion about this subject, see http://www.php.net/manual/en/security.hiding.php. DO NOT set PHP as the default file type, as is recommended by marpetr - doing so greatly simplifies malicious file upload attacks.
]]></Data>
  </Content>
</TeamMentor_Article>