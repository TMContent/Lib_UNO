<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="0" Content_Hash="0">
  <Metadata>
    <Id>178571b2-281f-4c50-ad5c-9b924696e54d</Id>
    <Id_History>178571b2-281f-4c50-ad5c-9b924696e54d,6700eb8c-298f-4844-a0c4-c7d2d1dd5bd0,</Id_History>
    <Library_Id>be5273b1-d682-4361-99d9-6234f2d47eb7</Library_Id>
    <Title>Parameterized APIs Are Used to Build XML Documents</Title>
    <Category>Dangerous APIs</Category>
    <Phase>Implementation</Phase>
    <Technology>PHP</Technology>
    <Type>Checklist Item</Type>
    <DirectLink>Parameterized APIs Are Used to Build XML Documents</DirectLink>
    <Author />
    <Priority />
    <Status />
  </Metadata>
  <Content Sanitized="false" DataType="wikitext">
    <Data><![CDATA[==Applies To==

* PHP

==What to Check For==

Verify that parameterized APIs are used to build XML documents.

==Why==

APIs that are designed for building XML documents will encode data properly to prevent attackers from manipulating XML data used by your application. A dangerous approach is to write your own set of functions to build XML documents by concatenating strings, or to modify an existing XML document by performing string operations. This means you have to take care of proper encoding yourself. Use APIs instead because they are simpler and safer.

==How to Check==

To verify that parameterized APIs are used to build XML documents:

# **Identify code that builds XML documents.** Make a spreadsheet of all the code that creates XML documents.
# **Review code that builds XML documents.** Examine code that builds XML documents to make sure that data is not concatenated with XML tags to build XML documents. The correct approach is to use XML parsers that provide functions for building XML documents, because these functions will then take care of properly encoding data to prevent XML injection vulnerabilities.

==How to Fix==

To use parameterized APIs to build XML documents:

# **Identify available APIs that can be used to build XML documents.** The XMLWriter extension can be used to build XML documents safely. There are other APIs that can be used for this task as well; choose one that best fits your application requirements. Whatever API you use, make sure not to concatenate XML tags and data.
# **Use parameterized APIs to build XML documents.** Use your chosen API to imlement code that builds XML documents. If you already have code that builds XML documents, make sure that it uses your chosen API and does not concatenate XML tags and data.

==Additional Resources==

* For information about XML manipulation in PHP, see http://www.php.net/manual/en/refs.xml.php
]]></Data>
  </Content>
</TeamMentor_Article>