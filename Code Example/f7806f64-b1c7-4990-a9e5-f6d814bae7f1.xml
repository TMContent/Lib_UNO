<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="705963325" Content_Hash="-820850892">
  <Metadata>
    <Id>f7806f64-b1c7-4990-a9e5-f6d814bae7f1</Id>
    <Id_History>f7806f64-b1c7-4990-a9e5-f6d814bae7f1,7407a6a1-eacb-43b1-a390-e70c2b0e232f,</Id_History>
    <Library_Id>be5273b1-d682-4361-99d9-6234f2d47eb7</Library_Id>
    <Title>Use ESAPI Encoder</Title>
    <Category>Encoding</Category>
    <Phase>Implementation</Phase>
    <Technology>Java</Technology>
    <Type>Code Example</Type>
    <DirectLink>Use ESAPI Encoder</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority />
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="html">
    <Data><![CDATA[<h1>Applies to</h1>
  <ul>
    <li>Java web-based applications.</li>
  </ul>
  <h1>Summary</h1>
  <span>
    <p>Use the ESAPI library to encode or decode data for usage in a given context. </p>
  </span>
  <h1>Objectives</h1>
  <span>
    <p>The ESAPI library provides an Encoder control that prepares data to be used in a given output context. Depending on the output context, this can prevent XSS or other types of injection (xml, xpath, OS, etc.).</p>
  </span>
  <h1>Scenarios</h1>
  <span>
    <p>Applications constantly send data to an output location, such as a database, flat file, web page, etc. Whenever this occurs, care must be taken to ensure special characters that are specific to the output context are either filtered or escaped to ensure proper functioning. The ESAPI library provides the Encoder control to manipulate data to be output into a given context. Various examples are given below of using the Encoder to safely escape data for various output contexts.</p>
  </span>
  <h1>Solution Example</h1>
  <span>
    <p>Sending data to a webpage in the HTML context:</p>
    <pre>&lt;div&gt;&lt;&amp;#37;= ESAPI.encoder().encodeForHTML(myString) &amp;#37;&gt;&lt;/div&gt;</pre>
    <p>Sending data to a webpage in the HTML attribute context:</p>
    <pre>&lt;input type="text" value="&lt;&amp;#37;= ESAPI.encoder().encodeForHTMLAttribute(myString) &amp;#37;&gt;" /&gt;</pre>
    <p>Sending data to a webpage in the JavaScript context:</p>
    <pre>var myVar = '&lt;&amp;#37;= ESAPI.encoder().encodeForJavaScript(myString) &amp;#37;&gt;';</pre>
    <p>Sending data to a webpage in the URL context (Note: This is only for url parameter values, NOT the entire url):</p>
    <pre>&lt;a href="/myapp/mypage.jsp?a=123&amp;b=&lt;&amp;#37;= ESAPI.encoder().encodeForURL(myString) &amp;#37;&gt;" /&gt;"&gt;Click me&lt;/a&gt;</pre>
    <p>Encode data in the Base64 format:</p>
    <pre>String base64Data = ESAPI.encoder().encodeForBase64(myStr);</pre>
  </span>
  <h1>See Also</h1>
  <ul>
    <li>For more information about Cross-Site Scripting prevention, see <a href="https://www.owasp.org/index.php/XSS_&amp;#37;28Cross_Site_Scripting&amp;#37;29_Prevention_Cheat_Sheet">https://www.owasp.org/index.php/XSS_&amp;#37;28Cross_Site_Scripting&amp;#37;29_Prevention_Cheat_Sheet</a><li>For more information about the OWASP ESAPI project, please see <a href="https://www.owasp.org/index.php/Category:OWASP_Enterprise_Security_API">https://www.owasp.org/index.php/Category:OWASP_Enterprise_Security_API</a></li></li>
  </ul>]]></Data>
  </Content>
</TeamMentor_Article>