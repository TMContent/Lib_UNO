<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="1095235368" Content_Hash="-1940119270">
  <Metadata>
    <Id>aa6bfb56-13d2-4561-8ed5-ba6a0468af43</Id>
    <Id_History>7346f667-d656-4fb1-b1d1-84cd75924dc9,</Id_History>
    <Library_Id>92718d53-36b2-47bc-b6f5-e60994385f46</Library_Id>
    <Title>How to Impersonate Declaratively In WCF</Title>
    <Category>Impersonation and Delegation</Category>
    <Phase>Implementation</Phase>
    <Technology>WCF 3.5</Technology>
    <Type>How To</Type>
    <DirectLink>How to Impersonate Declaratively In WCF</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>J.D. Meier, Jason Taylor, Prashant Bansode, Carlos Farre, Madhu Sundararajan, Rob Boucher, Steve Gregersen</Priority>
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<h1>Applies to</h1>
  <ul>
    <li>Microsoft&amp;#174; Windows Communication Foundation (WCF) 3.5 <li>Microsoft Visual Studio&amp;#174; 2008</li></li>
  </ul>
  <h1>Description</h1>
  <p>Use the OperationBehavior attribute to impersonate declaratively. There are two options for declarative impersonation:</p>
  <ul>
    <li>Impersonating on specific operations <li>Impersonating on the entire service</li></li>
  </ul>
  <p>
    <strong>Impersonating on specific operations<br /></strong>Use this option when you want to impersonate the original caller for the entire duration of specific operation. You can impersonate declaratively by applying the OperationBehaviorAttribute attribute on any operation that requires client impersonation, as shown in the following code example.</p>
  <pre>&amp;#91;OperationBehavior(Impersonation = ImpersonationOption.Required)&amp;#93;<br />public string GetData(int value)<br />&amp;#123;<br />   return &amp;#8220;test&amp;#8221;;<br />&amp;#125;</pre>
  <p>
    <strong>Impersonating on the entire service</strong>
    <br />Use this option when you want to impersonate the original caller for entire duration of all the operations. For impersonating the entire service set the impersonateCallerForAllOperations attribute to "true" in the WCF configuration file, as shown in the following example.</p>
  <pre>&amp;#8230;<br />&lt;behaviors&gt;<br />  &lt;serviceBehaviors&gt;<br />    &lt;behavior name="ServiceBehavior"&gt;<br />      &lt;serviceMetadata httpGetEnabled="true" /&gt;<br />      &lt;serviceDebug includeExceptionDetailInFaults="false" /&gt;<br />      &lt;serviceAuthorization impersonateCallerForAllOperations="true" /&gt;<br />    &lt;/behavior&gt;<br />  &lt;/serviceBehaviors&gt;<br />&lt;/behaviors&gt;<br />&amp;#8230;</pre>
  <p>When impersonating for all operations, the Impersonation property of the OperationBehaviorAttribute applied to each method must also be set to either Allowed or Required.</p>
  <h1>Additional Resources</h1>
  <ul>
    <li>For more information, see &amp;#8220;Delegation and Impersonation with WCF&amp;#8221; at <a href="http://msdn2.microsoft.com/en-us/library/ms730088.aspx">http://msdn2.microsoft.com/en-us/library/ms730088.aspx</a><li>For more information see &amp;#8220;How to Impersonate the Original Caller in WCF calling from Windows Forms&amp;#8221; at <a href="http://www.codeplex.com/WCFSecurityGuide/Wiki/View.aspx?title=How&amp;#37;20To&amp;#37;20-&amp;#37;20Impersonate&amp;#37;20the&amp;#37;20Original&amp;#37;20Caller&amp;#37;20in&amp;#37;20WCF&amp;#37;20calling&amp;#37;20from&amp;#37;20Windows&amp;#37;20Forms&amp;referringTitle=How&amp;#37;20Tos">http://www.codeplex.com/WCFSecurityGuide/Wiki/View.aspx?title=How&amp;#37;20To&amp;#37;20-&amp;#37;20Impersonate&amp;#37;20the&amp;#37;20Original&amp;#37;20Caller&amp;#37;20in&amp;#37;20WCF&amp;#37;20calling&amp;#37;20from&amp;#37;20Windows&amp;#37;20Forms&amp;referringTitle=How&amp;#37;20Tos</a><li>For more information see &amp;#8220;How to Impersonate the Original Caller in WCF calling from Web Application&amp;#8221; at <a href="http://www.codeplex.com/WCFSecurityGuide/Wiki/View.aspx?title=How&amp;#37;20To&amp;#37;20-&amp;#37;20Impersonate&amp;#37;20the&amp;#37;20Original&amp;#37;20Caller&amp;#37;20in&amp;#37;20WCF&amp;#37;20calling&amp;#37;20from&amp;#37;20Web&amp;#37;20Application&amp;referringTitle=How&amp;#37;20Tos">http://www.codeplex.com/WCFSecurityGuide/Wiki/View.aspx?title=How&amp;#37;20To&amp;#37;20-&amp;#37;20Impersonate&amp;#37;20the&amp;#37;20Original&amp;#37;20Caller&amp;#37;20in&amp;#37;20WCF&amp;#37;20calling&amp;#37;20from&amp;#37;20Web&amp;#37;20Application&amp;referringTitle=How&amp;#37;20Tos</a><li>For impersonation and delegation Q&amp;A, see the Impersonation/Delegation section of &amp;#8220;WCF 3.5 Questions and Answers&amp;#8220; at <a href="http://www.codeplex.com/WCFSecurityGuide/Wiki/View.aspx?title=Questions&amp;#37;20and&amp;#37;20Answers&amp;referringTitle=Home">http://www.codeplex.com/WCFSecurityGuide</a>&amp;nbsp;</li></li></li></li>
  </ul>
  <hr />
  <p>Adapted from Microsoft patterns &amp; practices guidance.</p>]]></Data>
  </Content>
</TeamMentor_Article>