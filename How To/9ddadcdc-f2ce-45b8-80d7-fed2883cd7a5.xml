<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="-235681371" Content_Hash="651205566">
  <Metadata>
    <Id>9ddadcdc-f2ce-45b8-80d7-fed2883cd7a5</Id>
    <Id_History>3eb6045e-2d66-4063-9a7b-fa094dc21554,</Id_History>
    <Library_Id>ea854894-8e16-46c8-9c61-737ef46d7e82</Library_Id>
    <Title>How to Use DPAPI To Protect Sensitive Data</Title>
    <Category>Sensitive Data</Category>
    <Phase>Implementation</Phase>
    <Technology>.NET 2.0</Technology>
    <Type>How To</Type>
    <DirectLink />
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>J.D. Meier, Alex Mackman, Blaine Wastell, Prashant Bansode, Chaitanya Bijwe</Priority>
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<h1>Applies to</h1>
  <ul>
    <li>.NET 2.0</li>
  </ul>
  <h1>Description</h1>
  <p>To use DPAPI to encrypt sensitive data in configuration files, use the <b>DataProtectionConfigurationProvider </b>class. To encrypt sensitive data with DPAPI in ASP.NET Web.config files, use Aspnet_regiis.exe. For Windows applications, use the protected configuration API. For more information, see the section, <a href="http://msdn.microsoft.com/library/en-us/dnpag2/html/PAGPractices0002.asp?frame=true#pagpractices0002_senshtencrypt" target="_self">How to Encrypt Configuration Data in Configuration Files</a>. </p>
  <p>To use DPAPI to encrypt data in other locations, such as the registry, use the <b>ProtectedData</b> class. </p>
  <pre>using System.Security.Cryptography;<br />// Define an entropy value (use of entropy is optional).<br />byte&#91;&#93; entropy = new byte&#91;&#93; &#123; 0x23, 0x06, 0x08, 0x09, 0x22, 0x03, 0x25 &#125;;<br />// Get the original data in a byte array.<br />byte&#91;&#93; toEncrypt = UnicodeEncoding.ASCII.GetBytes(<br />                   "The secret data to be encrypted");<br />// Encrypt the data by the using ProtectedData class. This example uses<br />// the local machine key store.<br />byte&#91;&#93; encryptedData = ProtectedData.Protect(toEncrypt, entropy,<br />                       DataProtectionScope.LocalMachine);</pre>
  <h1>Additional Resources</h1>
  <ul>
    <li>For more information, see the section, <a href="http://msdn.microsoft.com/library/en-us/dnpag2/html/PAGPractices0002.asp?frame=true#pagpractices0002_senshtencrypt" target="_self">How to Encrypt Configuration Data in Configuration Files</a>. <li>For more information see, "Security Practices: .NET Framework 2.0 Security Practices at a Glance" at <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnpag2/html/PAGPractices0002.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnpag2/html/PAGPractices0002.asp</a></li></li>
  </ul>
  <hr />
  <p>Adapted from Microsoft patterns & practices guidance.</p>]]></Data>
  </Content>
</TeamMentor_Article>