<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="-232055168" Content_Hash="696465978">
  <Metadata>
    <Id>5df90a51-bcb6-4f51-98b1-9d5dd0a1e2ec</Id>
    <Id_History>5df90a51-bcb6-4f51-98b1-9d5dd0a1e2ec,ccc77590-f5ff-49d0-bfd7-75349b04bb17,</Id_History>
    <Library_Id>92718d53-36b2-47bc-b6f5-e60994385f46</Library_Id>
    <Title>How to Avoid Faulting the Channels with Fault Contracts</Title>
    <Category>Error and Exception Management</Category>
    <Phase>Implementation</Phase>
    <Technology>WCF</Technology>
    <Type>How To</Type>
    <DirectLink>How to Avoid Faulting the Channels with Fault Contracts</DirectLink>
    <Tag>WCF 3.5</Tag>
    <Security_Demand />
    <Author />
    <Priority>J.D. Meier, Jason Taylor, Prashant Bansode, Carlos Farre, Madhu Sundararajan, Rob Boucher, Steve Gregersen</Priority>
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<h1>Applies to</h1>
  <ul>
    <li>Microsoft® Windows Communication Foundation (WCF) 3.5 
<li>Microsoft Visual Studio® 2008</li></li>
  </ul>
  <h1>Description</h1>
  <p>When calling a WCF service, if there are any exceptions thrown by the service, the communication channel goes into the faulted state, and you cannot use the proxy for any further calls. This can be avoided by throwing FaultException in your service operations. The service operation that throws a FaultException must be decorated with one or more FaultContract attributes.</p>
  <ol>
    <li>Define a Fault contract by applying the FaultContract attribute directly on a contract operation, and specifying the error detailing type to the method as shown below:
<ol><pre>[ServiceContract]<br />interface ICalculator<br />{<br />   [OperationContract]<br />   [FaultContract(typeof(DivideByZeroException))]<br />   double Divide(double number1,double number2);<br />}</pre></ol><li>Implement the Divide operation which throw the fault and have it propagated to the client by throwing exactly the same detailing type listed in the fault contract.
<ol><pre>class MyService : ICalculator<br />{<br />   public double Divide(double number1,double number2)<br />   {<br />      throw new FaultException&lt;DivideByZeroException&gt;(new DivideByZeroException());<br />   }<br />}</pre></ol><li>Handle the faults at the client by catching the FaultException and also other communication exceptions that could occur when calling the service operations.
<ol><pre>try<br />{<br />  proxy.Divide();<br />}<br />catch (FaultException&lt;DivideByZeroException&gt; ex)<br />{<br />  // only if a fault contract of type DivideByZeroException was specified <br />}</pre><pre>catch (FaultException ex)<br />{<br />  // any other faults <br />}</pre><pre>catch (CommunicationException ex)<br />{<br />  // any communication errors? <br />} </pre></ol></li></li></li>
  </ol>
  <h1>Additional Resources</h1>
  <ul>
    <li>For more information on Fault Contracts, see “Specifying and Handling Faults in Contracts and Services” at <a href="http://msdn.microsoft.com/en-us/library/ms733721.aspx">http://msdn.microsoft.com/en-us/library/ms733721.aspx</a></li>
  </ul>
  <hr />
  <p>Adapted from Microsoft patterns & practices guidance.</p>]]></Data>
  </Content>
</TeamMentor_Article>