<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="1162521639" Content_Hash="-282458635">
  <Metadata>
    <Id>e82fefe8-87f9-4957-8cc6-ce6838a91a77</Id>
    <Id_History>0249399c-c1b0-4e75-928c-8414ac967837,</Id_History>
    <Library_Id>ea854894-8e16-46c8-9c61-737ef46d7e82</Library_Id>
    <Title>How to Inspect For Dangerous Unmanaged APIs</Title>
    <Category>Unmanaged Code</Category>
    <Phase>Implementation</Phase>
    <Technology>.NET 2.0</Technology>
    <Type>How To</Type>
    <DirectLink>How to Inspect For Dangerous Unmanaged APIs</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>J.D. Meier, Alex Mackman, Blaine Wastell, Prashant Bansode, Chaitanya Bijwe</Priority>
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<h1>Applies to</h1>
  <ul>
    <li>.NET 2.0</li>
  </ul>
  <h1>Description</h1>
  <p>You should be able to justify the use of all Win32 API calls. Unsafe APIs include threading functions that switch security context, such as <b>CreateThread</b>, <b>RevertToSelf</b> and access token functions, which can create tokens and can modify or disclose information about a security token. These include <b>AdjustTokenGroups</b>, <b>AdjustTokenPrivileges</b>, <b>SetTokenInformation</b>, <b>and GetTokenInformation</b>. Other unsafe APIs include credential management functions, including functions that create tokens, such as <b>LogonUser</b> and <b>LogonUserEx</b>, crypto API functions that can decrypt and access private keys, memory management functions that can read and write to memory and Local Security Authority (LSA) functions that can access sensitive system data.</p>
  <br />
  <hr />
  <p>Adapted from Microsoft patterns &amp; practices guidance.</p>]]></Data>
  </Content>
</TeamMentor_Article>