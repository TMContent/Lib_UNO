<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="1114025091" Content_Hash="2070622920">
  <Metadata>
    <Id>d605592c-4cff-4e24-9022-4e7c8afbc67c</Id>
    <Id_History>e02887bd-bcd7-4a07-82fd-b40302205238,</Id_History>
    <Library_Id>ea854894-8e16-46c8-9c61-737ef46d7e82</Library_Id>
    <Title>Minimize the Exposure of Secrets in Memory</Title>
    <Category>Sensitive Data</Category>
    <Phase>Implementation</Phase>
    <Technology>.NET 2.0</Technology>
    <Type>Guideline</Type>
    <DirectLink>Minimize the Exposure of Secrets in Memory</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>J.D. Meier, Srinath Vasireddy, Ashish Babbar, Rico Mariani, and Alex Mackman</Priority>
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<h1>Applies to</h1>
  <ul>
    <li>.NET 2.0</li>
  </ul>
  <h1>What to Do</h1>
  <p>When manipulating secrets, consider how the secret data is stored in memory. How long is the secret data retained in clear text format?</p>
  <h1>Why</h1>
  <p>Clear text secrets held in your process address space are vulnerable if an attacker is able to probe your application's address space. Also, if the page of memory containing the secret is swapped out to the page file, the secret data is vulnerable if someone gains access to the page file. Similarly, clear text secrets held in memory appear in the crash dump file if a process crashes.</p>
  <h1>When</h1>
  <p>When working with sensitive data within your application.</p>
  <h1>How</h1>
  <p>To minimize the exposure of secrets in memory, consider the following measures: </p>
  <ul>
    <li>
      <b>Avoid creating multiple copies of the secret</b>. Having multiple copies of the secret data increases your attack surface. Pass references to secret data instead of making copies of the data. Also realize that if you store secrets in immutable <b>System.String</b> objects, after each string manipulation, a new copy is created. </li>
    <li>
      <b>Keep the secret encrypted for as long as possible</b>. Decrypt the data at the last possible moment before you need to use the secret. </li>
    <li>
      <b>Clean the clear text version of the secret as soon as you can</b>. Replace the clear text copy of the secret data with zeros as soon as you have finished with it.</li>
  </ul>
  <p>Prior to .NET Framework 2.0, the use of byte arrays was recommended to help implement these guidelines. Byte arrays can be pinned in memory, encrypted, and replaced with zeros. In .NET Framework 2.0, use <b>SecureString</b> instead.</p>
  <hr />
  <p>Adapted from Microsoft patterns &amp; practices guidance.</p>]]></Data>
  </Content>
</TeamMentor_Article>