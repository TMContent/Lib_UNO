<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="-1499295894" Content_Hash="1491680006">
  <Metadata>
    <Id>c9273b8f-07e5-4b05-ada9-e5a3d6a785a8</Id>
    <Id_History>5b3b4102-a4dc-452c-9f23-b66368308359,</Id_History>
    <Library_Id>be5273b1-d682-4361-99d9-6234f2d47eb7</Library_Id>
    <Title>Use Replay Detection to Protect Against Message Replay Attacks</Title>
    <Category>Hardening</Category>
    <Phase>Implementation</Phase>
    <Technology>WCF 3.5</Technology>
    <Type>Guideline</Type>
    <DirectLink>Use Replay Detection to Protect Against Message Replay Attacks</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>J.D. Meier, Jason Taylor, Prashant Bansode, Carlos Farre, Madhu Sundararajan, Rob Boucher, Steve Gregersen</Priority>
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<h1>Applies to</h1>
  <ul>
    <li>Microsoft&amp;#174; Windows Communication Foundation (WCF) 3.5 <li>Microsoft Visual Studio&amp;#174; 2008</li></li>
  </ul>
  <h1>What to Do</h1>
  <p>Use the WCF replay detection feature to protect your service against message replay attacks. </p>
  <h1>Why</h1>
  <p>To prevent from message replay attacks.</p>
  <h1>How</h1>
  <p>A message replay attack occurs when an attacker copies a stream of messages between two parties and replays the stream to one or more of the parties. Unless mitigated, the computers subject to the attack will process the stream as legitimate messages, resulting in a range of harmful consequences including unauthorized access to the service.</p>
  <p>To enable replay detection in your service:</p>
  <ol>
    <li>Create a customBinding Element. <li>Create a &lt;security&gt; element. <li>Create a localClientSettings element or localServiceSettings element. <li>Set the following attribute values, as appropriate: detectReplays, maxClockSkew, replayWindow, and replayCacheSize. </li></li></li></li>
  </ol>
  <p>The following example sets the attributes of both a &lt;localServiceSettings&gt; and a &lt;localClientSettings&gt; element:</p>
  <pre>&lt;customBinding&gt;<br />  &lt;binding name="NewBinding0"&gt;<br />   &lt;textMessageEncoding /&gt;<br />    &lt;security&gt;<br />     &lt;localClientSettings <br />      replayCacheSize="800000" <br />      maxClockSkew="00:03:00"<br />      replayWindow="00:03:00" /&gt;<br />     &lt;localServiceSettings <br />      replayCacheSize="800000" <br />      maxClockSkew="00:03:00"<br />      replayWindow="00:03:00" /&gt;<br />    &lt;secureConversationBootstrap /&gt;<br />   &lt;/security&gt;<br />  &lt;httpTransport /&gt;<br /> &lt;/binding&gt;<br />&lt;/customBinding&gt; </pre>
  <h1>Additional Resources</h1>
  <ul>
    <li>For more information on replay detection, see &amp;#8220;How to: Enable Message Replay Detection&amp;#8221; at <a href="http://msdn2.microsoft.com/en-us/library/ms733063.aspx">http://msdn2.microsoft.com/en-us/library/ms733063.aspx</a><li>For configuration management Q&amp;A, see the Configuration Management section of &amp;#8220;WCF 3.5 Questions and Answers &amp;#8220; at <a href="http://www.codeplex.com/WCFSecurityGuide/Wiki/View.aspx?title=WCF&amp;#37;20Questions&amp;#37;20and&amp;#37;20Answers&amp;#37;20&amp;#37;28Q&amp;#37;26A&amp;#37;29&amp;referringTitle=Home">http://www.codeplex.com/WCFSecurityGuide/Wiki/View.aspx?title=WCF&amp;#37;20Questions&amp;#37;20and&amp;#37;20Answers&amp;#37;20&amp;#37;28Q&amp;#37;26A&amp;#37;29&amp;referringTitle=Home</a><a href="http://www.codeplex.com/WCFSecurity/Wiki/View.aspx?title=Questions&amp;#37;20and&amp;#37;20Answers&amp;referringTitle=Home"></a></li></li>
  </ul>
  <hr />
  <p>Adapted from Microsoft patterns &amp; practices guidance.</p>]]></Data>
  </Content>
</TeamMentor_Article>