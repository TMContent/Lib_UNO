<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="664273310" Content_Hash="300636188">
  <Metadata>
    <Id>84fd606b-e2f2-4c48-9c6e-6b5e780c6163</Id>
    <Id_History>84fd606b-e2f2-4c48-9c6e-6b5e780c6163,1edab30d-254f-4911-9679-25056e97da82,</Id_History>
    <Library_Id>be5273b1-d682-4361-99d9-6234f2d47eb7</Library_Id>
    <Title>Force Reauthentication When Executing Critical Functionality</Title>
    <Category>Authentication</Category>
    <Phase>Implementation</Phase>
    <Technology>Java</Technology>
    <Type>Code Example</Type>
    <DirectLink>Force Re-authentication When Executing Critical Functionality</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>2</Priority>
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="html">
    <Data><![CDATA[<h1>Applies to</h1>
  <ul>
    <li>Applications written using Servlets or JSP.</li>
  </ul>
  <h1>Problem Example</h1>
  <p>The following code allows a user to change their credentials. Unfortunately, the code enters the new credentials into the credentials repository without verifying that it is the actual user changing the credentials.</p>
  <pre>public boolean changePassword(String user, char[] newPass)<br />{<br />       // The application fails to re-authenticate the user<br />       // Verify that new password meets password requirements<br />       // Update the credential store with the new password<br />}</pre>
  <h1>Solution Example</h1>
  <p>The following code allows a user to change their credentials. Before entering the new credentials into the credentials repository, the code verifies that it is the actual user doing the credentials change.</p>
  <pre>public boolean changePassword(String user, char[] oldPass, char[] newPass)<br />{<br />      // The application forces re-authentication<br />      if(!validateUser(user, oldPass))<br />      {<br />            return false;<br />      }<br />      // Verify that new password meets password requirements<br />      // Update the credential store with the new password<br />}</pre>
  <br />]]></Data>
  </Content>
</TeamMentor_Article>