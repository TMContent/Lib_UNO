<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="1067926136" Content_Hash="-810293224">
  <Metadata>
    <Id>697891eb-5d97-44fa-a6eb-625f247f622d</Id>
    <Id_History>697891eb-5d97-44fa-a6eb-625f247f622d,92809a74-cadd-4d5b-91d1-623086855c30,</Id_History>
    <Library_Id>be5273b1-d682-4361-99d9-6234f2d47eb7</Library_Id>
    <Title>Use Least Privileged Accounts for Database Access</Title>
    <Category>Database Security</Category>
    <Phase>Implementation</Phase>
    <Technology>Java</Technology>
    <Type>How To</Type>
    <DirectLink>Use Least Privileged Accounts for Database Access</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>2</Priority>
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="html">
    <Data><![CDATA[<h1>Applies to</h1>
  <ul>
    <li>Applications written using Servlets or JSP&nbsp;that interact with a database.</li>
  </ul>
  <h1>What to Do</h1>
  <p>Apply the principle of least privilege to any accounts used by the application to access the backend database server.</p>
  <h1>Why</h1>
  <p>Applying the principle of least privilege to all of the application's database accounts reduces the damage potential if such accounts get compromised by an attacker.</p>
  <h1>When</h1>
  <p>Apply least privileges any time&nbsp;your application uses a backend database server. </p>
  <h1>How</h1>
  <p>To apply the principle of least privilege to the application's database accounts:</p>
  <ol>
    <li>
      <p>
        <strong>Identify all database accounts. </strong>Create a list&nbsp;of all of your application's database accounts&nbsp;and the respective servers and databases that they connect to.</p>
      <li>
        <p>
          <strong>Identify the roles associated with each database account. </strong>Understand the purpose of&nbsp;each account and the functionality&nbsp;each will be executing. Using a table, map all accounts to the minimum privileges they require. None of the application's accounts should have administrative rights on the database server:</p>
        <pre>Accounts     Actions    Stored Proc     Users Table<br />------------------------------------------------------<br />app_admin    Connect       Always         Always<br />             Read          Always         Always<br />             Use           Always         Occasionally<br />             Modify        Never          Occasionally<br />app_normal   Connect       Always         Always<br />             Read          Always         Always<br />             Use           Always         Always<br />             Modify        Never          Never</pre>
        <li>
          <p>
            <strong>Set appropriate privileges. </strong>Once all accounts and their roles have been identified, set the appropriate privileges at the respective database servers. Make sure that each account has enough privileges to execute the assigned tasks only. Any extra privileges should be revoked.</p>
          <pre>sql&gt; select host, user, select_priv, drop_priv, shutdown_priv from user;<br />&#43;----------------&#43;-------&#43;-------------&#43;-----------&#43;---------------&#43;<br />&#124; host           &#124; user  &#124; select_priv &#124; drop_priv &#124; shutdown_priv &#124;<br />&#43;----------------&#43;-------&#43;-------------&#43;-----------&#43;---------------&#43;<br />&#124; 192.168.10.220 &#124; myapp &#124; Y           &#124; N         &#124; N             &#124;<br />&#43;----------------&#43;-------&#43;-------------&#43;-----------&#43;---------------&#43;</pre>
        </li>
      </li>
    </li>
  </ol>
  <h1>Problem Example</h1>
  <p>The following snippet shows a list of database accounts and some of their permissions. Unfortunately, the application's account is given more privileges than necessary. If an attacker compromises the application's database account, he can drop tables and shutdown the actual database server.</p>
  <pre>sql&gt; select host, user, select_priv, drop_priv, shutdown_priv from user;<br />&#43;----------------&#43;-------&#43;-------------&#43;-----------&#43;---------------&#43;<br />&#124; host           &#124; user  &#124; select_priv &#124; drop_priv &#124; shutdown_priv &#124;<br />&#43;----------------&#43;-------&#43;-------------&#43;-----------&#43;---------------&#43;<br />&#124; localhost      &#124; root  &#124; Y           &#124; Y         &#124; Y             &#124;<br />&#124; 192.168.10.220 &#124; myapp &#124; Y           &#124; Y         &#124; Y             &#124;<br />&#43;----------------&#43;-------&#43;-------------&#43;-----------&#43;---------------&#43;</pre>
  <h1>Solution Example</h1>
  <p>The following snippet shows a list of database accounts and some of their permissions. Because the application's account is given appropriate permissions, an attacker cannot drop tables and shutdown the database server by compromising the application's database account:</p>
  <pre>sql&gt; select host, user, select_priv, drop_priv, shutdown_priv from user;<br />&#43;----------------&#43;-------&#43;-------------&#43;-----------&#43;---------------&#43;<br />&#124; host           &#124; user  &#124; select_priv &#124; drop_priv &#124; shutdown_priv &#124;<br />&#43;----------------&#43;-------&#43;-------------&#43;-----------&#43;---------------&#43;<br />&#124; localhost      &#124; root  &#124; Y           &#124; Y         &#124; Y             &#124;<br />&#124; 192.168.10.220 &#124; myapp &#124; Y           &#124; N         &#124; N             &#124;<br />&#43;----------------&#43;-------&#43;-------------&#43;-----------&#43;---------------&#43;</pre>]]></Data>
  </Content>
</TeamMentor_Article>