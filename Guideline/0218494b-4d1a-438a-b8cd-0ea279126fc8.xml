<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="549151212" Content_Hash="389176749">
  <Metadata>
    <Id>0218494b-4d1a-438a-b8cd-0ea279126fc8</Id>
    <Id_History>2074737f-e86b-4482-918e-4dffe2110e92,</Id_History>
    <Library_Id>ea854894-8e16-46c8-9c61-737ef46d7e82</Library_Id>
    <Title>Return Generic Error Pages with Harmless Messages to the Client</Title>
    <Category>Error and Exception Management</Category>
    <Phase>Implementation</Phase>
    <Technology>ASP.NET 2.0</Technology>
    <Type>Guideline</Type>
    <DirectLink>Return Generic Error Pages with Harmless Messages to the Client</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>J.D. Meier, Alex Mackman, Blaine Wastell, Prashant Bansode, Andy Wigley, Kishore Gopalan</Priority>
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<h1>Applies to</h1>
  <ul>
    <li>ASP.NET 2.0 </li>
  </ul>
  <h1>What to Do</h1>
  <p>Avoid using custom error pages to denote error states that are returned to the client. </p>
  <h1>Why</h1>
  <p>Exceptions contain debugging information that could constitute an information disclosure. Be careful with custom error pages they may also implicitly provide unintended information as a side effect.&amp;nbsp;&amp;nbsp;</p>
  <h1>When</h1>
  <p>This&amp;nbsp;guideline is applicable whenever there are error pages to be returned&amp;nbsp;from an application. </p>
  <h1>How</h1>
  <p>Standardize the error pages, and scrutinize their design and presentation carefully to avoid inadvertent information disclosure. Avoid displaying debug information in error pages. See the related guidelines section that follows for more details. </p>
  <h1>Problem Example</h1>
  <p>Consider the following code. There are two defined error states:<br />1.&amp;nbsp;user is not valid for the given application<br />2.&amp;nbsp;username/password combination is incorrect</p>
  <pre>// check<br />If(user_exists($username))<br />{<br />&amp;nbsp;&amp;nbsp; If(authentication_fails($username, $password))<br />&amp;nbsp;&amp;nbsp; {<br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Display_error_page(‘username or password bad, please try again’);<br />&amp;nbsp;&amp;nbsp; }<br />&amp;nbsp;&amp;nbsp; Else<br />&amp;nbsp;&amp;nbsp; {<br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //authentication succeeded! Login normally<br />&amp;nbsp;&amp;nbsp; }<br />}<br />Else<br />{<br />&amp;nbsp;&amp;nbsp; Display_error_page(‘user does not exist, <br />	please &lt;a href=”foobar.com/register.asp?uid=’.clean($username) . ‘”&gt;register!&lt;/a&gt;’);<br />}<br />&amp;nbsp; </pre>
  <p>In the preceding example, the developer is clever; usernames that are not taken are presented with a URL to register for a new account using that username. </p>
  <p>But the error message for a valid user that enters a bad password is completely different! A subtle difference, but a keen observer will note that this enables </p>
  <p>them to discover valid accounts on the system. </p>
  <h1>Solution Example</h1>
  <pre>// check<br />If(user_exists($username))<br />{<br />&amp;nbsp;&amp;nbsp; If(authentication_fails($username, $password))<br />&amp;nbsp;&amp;nbsp; {<br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Display_error_page(‘username or password bad, please try again’);<br />&amp;nbsp;&amp;nbsp; }<br />&amp;nbsp;&amp;nbsp; Else<br />&amp;nbsp;&amp;nbsp; {<br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; //authentication succeeded! Login normally<br />&amp;nbsp;&amp;nbsp; }<br />}<br />Else<br />{<br />&amp;nbsp;&amp;nbsp; Display_error_page(‘username or password bad, please try again’);<br />}</pre>
  <p>The solution is rather simple; standardize the return message so that the client cannot discern these two states from the error message alone.</p>
  <p>&amp;nbsp;NOTE: the preceding code segments are not production quality, in that there might be other avenues of attack involving parameter tampering, SQL injection, as well as others. The aforementioned examples serve only to demonstrate a point and should not be construed as secure given their present context. <br /></p>
  <hr />
  <p>Adapted from Microsoft patterns &amp; practices guidance.</p>]]></Data>
  </Content>
</TeamMentor_Article>