<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="-1697172475" Content_Hash="484013154">
  <Metadata>
    <Id>b10b6413-9c73-4040-b585-3d6a3dabf8f4</Id>
    <Id_History>ee0e905e-5836-4f23-8719-564ed7884023,</Id_History>
    <Library_Id>26bd1a04-beed-4a66-917d-b6ab0a7d634c</Library_Id>
    <Title>Local Machine Credential Sniffing Vulnerability</Title>
    <Category>Authentication</Category>
    <Phase>Implementation</Phase>
    <Technology> Any</Technology>
    <Type>Vulnerability</Type>
    <DirectLink>Local Machine Credential Sniffing Vulnerability</DirectLink>
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>2</Priority>
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<h1>Applies To</h1>
  <p>
  </p>
  <ul>
    <li>All applications</li>
  </ul>
  <p />
  <h1>Impact</h1>
  <ul>
    <li>Information Disclosure</li>
  </ul>
  <h1>Underlying Fault</h1>
  <ul>
    <li>Failure to use proper encryption techniques. </li>
    <li>Using default or insecure permission sets. </li>
    <li>Writing sensitive data to locations discoverable by attackers.</li>
  </ul>
  <h1>Description</h1>
  <p>Many applications assume that malicious software will never be executed on the local machine. However, in today's world of ubiquitous spyware, viruses, and trojans, relying on this assumption can lead to the loss of sensitive information like credentials. If an attacker can somehow trick a user into installing malicious software, it may be possible to recover sensitive information from the file system or other local machine resources. An attacker may look through temporary files, registry keys, swap files, config files, etc. to discover sensitive data such as username/password pairs, database connection strings, or other data that should be protected.</p>
  <h1>Example</h1>
  <h3>
    <strong>Sensitive Data in Temporary Files</strong>
  </h3>
  <p>An application writes an encryption key to the disk as a temporary file while it's not using it to free up space in memory. When the encryption key is no longer used the developer calls the<i> File.Delete</i> operation which deletes the file from disk. </p>
  <p>In this case it is trivial for an attacker to open an application that allows her to read the contents of the file from disk, even after the delete function had been called.</p>
  <p>To ensure the contents of this file is unrecoverable it must be securely deleted by overwriting the bits on disk. The file should always be protected with encryption or with explicitly set permissions to make sure that the file is not discoverable before it is deleted.</p>
  <h1>Countermeasures</h1>
  <ul>
    <li>Do not write any sensitive information out to the file system or registry in plaintext. </li>
    <li>Encrypt any sensitive data that must be stored. </li>
    <li>Explicitly set permissions on temporary files. </li>
    <li>Keep sensitive information in memory for as little time as possible. </li>
    <li>Overwrite sensitive data files on disk using a secure delete function.</li>
  </ul>
  <ul>
  </ul>
  <h1>Additional Resources</h1>
  <ul>
    <li>For information about insecure temporary files, see&amp;nbsp;<a href="http://www.owasp.org/index.php/Insecure_Temporary_File">http://www.owasp.org/index.php/Insecure_Temporary_File</a></li>
  </ul>]]></Data>
  </Content>
</TeamMentor_Article>